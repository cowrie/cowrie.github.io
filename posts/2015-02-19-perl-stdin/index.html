<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Interesting Perl scripts through stdin | Cowrie</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="This came in recently in one of my honeypots, same IP address that attempted to download SSH bruteforcing scripts before, but this latest attempt shows a new method of operations. In the log below you can see they attempt to run &lsquo;perl&rsquo;. Kippo accepts the perl command, but we don&rsquo;t see what&rsquo;s executed.
2015-02-17 08:13:56+0000 [kippo.core.ssh.HoneyPotSSHFactory] New connection: AAA.BBB.CCC.DDD:40346 (127.0.0.1:2222) [session: 491] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported key exchange: ['diffie-hellman-group14-sha1', 'diffie-hellman-group-exchange-sha1', 'diffie-hellman -group1-sha1'] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.">
<meta name=generator content="Hugo 0.91.2">
<meta name=robots content="noindex, nofollow">
<link rel=stylesheet href=/ananke/css/main.min.css>
<link rel=stylesheet href=/asciinema-player.css>
<meta property="og:title" content="Interesting Perl scripts through stdin">
<meta property="og:description" content="This came in recently in one of my honeypots, same IP address that attempted to download SSH bruteforcing scripts before, but this latest attempt shows a new method of operations. In the log below you can see they attempt to run &lsquo;perl&rsquo;. Kippo accepts the perl command, but we don&rsquo;t see what&rsquo;s executed.
2015-02-17 08:13:56+0000 [kippo.core.ssh.HoneyPotSSHFactory] New connection: AAA.BBB.CCC.DDD:40346 (127.0.0.1:2222) [session: 491] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported key exchange: ['diffie-hellman-group14-sha1', 'diffie-hellman-group-exchange-sha1', 'diffie-hellman -group1-sha1'] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.cowrie.org/posts/2015-02-19-perl-stdin/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2015-02-19T00:00:00+00:00">
<meta property="article:modified_time" content="2015-02-19T00:00:00+00:00">
<meta itemprop=name content="Interesting Perl scripts through stdin">
<meta itemprop=description content="This came in recently in one of my honeypots, same IP address that attempted to download SSH bruteforcing scripts before, but this latest attempt shows a new method of operations. In the log below you can see they attempt to run &lsquo;perl&rsquo;. Kippo accepts the perl command, but we don&rsquo;t see what&rsquo;s executed.
2015-02-17 08:13:56+0000 [kippo.core.ssh.HoneyPotSSHFactory] New connection: AAA.BBB.CCC.DDD:40346 (127.0.0.1:2222) [session: 491] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported key exchange: ['diffie-hellman-group14-sha1', 'diffie-hellman-group-exchange-sha1', 'diffie-hellman -group1-sha1'] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA."><meta itemprop=datePublished content="2015-02-19T00:00:00+00:00">
<meta itemprop=dateModified content="2015-02-19T00:00:00+00:00">
<meta itemprop=wordCount content="5466">
<meta itemprop=keywords content="ssh,honeypot,perl,cowrie,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Interesting Perl scripts through stdin">
<meta name=twitter:description content="This came in recently in one of my honeypots, same IP address that attempted to download SSH bruteforcing scripts before, but this latest attempt shows a new method of operations. In the log below you can see they attempt to run &lsquo;perl&rsquo;. Kippo accepts the perl command, but we don&rsquo;t see what&rsquo;s executed.
2015-02-17 08:13:56+0000 [kippo.core.ssh.HoneyPotSSHFactory] New connection: AAA.BBB.CCC.DDD:40346 (127.0.0.1:2222) [session: 491] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported key exchange: ['diffie-hellman-group14-sha1', 'diffie-hellman-group-exchange-sha1', 'diffie-hellman -group1-sha1'] 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.">
</head>
<body class="ma0 avenir bg-near-white">
<header class="cover bg-top" style=background-image:url(https://www.cowrie.org/images/camel-bg.jpg)>
<div class=bg-black-60>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Cowrie
</a>
<div class="flex-l items-center">
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/contact/ title="Contact page">
Contact
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/download/ title="Download page">
Download
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/mail/ title="Mailing List page">
Mailing List
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/posts/ title="Posts page">
Posts
</a>
</li>
</ul>
<div class=ananke-socials>
<a href=https://twitter.com/micheloosterhof target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a>
<a href=https://github.com/cowrie/cowrie target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a>
</div>
</div>
</div>
</nav>
<div class="tc-l pv6 ph3 ph4-ns">
<h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Interesting Perl scripts through stdin</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class="mt3 ananke-socials">
<a href="https://twitter.com/share?url=https://www.cowrie.org/posts/2015-02-19-perl-stdin/&text=Interesting%20Perl%20scripts%20through%20stdin" class="ananke-social-link twitter no-underline" aria-label="share on Twitter">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Interesting Perl scripts through stdin</h1>
<p class=tracked>
By <strong>Michel Oosterhof</strong>
</p>
<time class="f6 mv4 dib tracked" datetime=2015-02-19T00:00:00Z>February 19, 2015</time>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>This came in recently in one of my honeypots, same IP address that attempted to download SSH bruteforcing scripts before, but this latest attempt shows a new method of operations.
In the log below you can see they attempt to run &lsquo;perl&rsquo;. Kippo accepts the perl command, but we don&rsquo;t see what&rsquo;s executed.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>2015-02-17 08:13:56+0000 [kippo.core.ssh.HoneyPotSSHFactory] New connection: AAA.BBB.CCC.DDD:40346 (127.0.0.1:2222) [session: 491]
2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported key exchange: [&#39;diffie-hellman-group14-sha1&#39;, &#39;diffie-hellman-group-exchange-sha1&#39;, &#39;diffie-hellman
-group1-sha1&#39;]
2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported public keys: [&#39;ssh-rsa&#39;, &#39;ssh-dss&#39;]
2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported encryption: [&#39;aes128-ctr&#39;, &#39;aes192-ctr&#39;, &#39;aes256-ctr&#39;, &#39;aes256-cbc&#39;, &#39;rijndael-cbc@lysator.liu.se&#39;,
 &#39;aes192-cbc&#39;, &#39;aes128-cbc&#39;, &#39;blowfish-cbc&#39;, &#39;arcfour128&#39;, &#39;arcfour&#39;, &#39;cast128-cbc&#39;, &#39;3des-cbc&#39;]
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported MAC: [&#39;hmac-sha1&#39;, &#39;hmac-sha1-96&#39;, &#39;hmac-md5&#39;, &#39;hmac-md5-96&#39;, &#39;hmac-ripemd160&#39;, &#39;hmac-ripemd160@ope
 nssh.com&#39;]
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported compression: [&#39;none&#39;]
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] KEXINIT: client supported lang: [&#39;&#39;]
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] Remote SSH version: SSH-2.0-OpenSSH_4.3
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] kex alg, key alg: diffie-hellman-group-exchange-sha1 ssh-rsa
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] outgoing: aes128-ctr hmac-sha1 none
 2015-02-17 08:13:57+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] incoming: aes128-ctr hmac-sha1 none
 2015-02-17 08:13:58+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] NEW KEYS
 2015-02-17 08:13:58+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] starting service ssh-userauth
 2015-02-17 08:13:58+0000 [SSHService ssh-userauth on HoneyPotTransport,491,AAA.BBB.CCC.DDD] root trying auth none
 2015-02-17 08:13:59+0000 [SSHService ssh-userauth on HoneyPotTransport,491,AAA.BBB.CCC.DDD] root trying auth password
 2015-02-17 08:13:59+0000 [SSHService ssh-userauth on HoneyPotTransport,491,AAA.BBB.CCC.DDD] login attempt [root/P3rs0N4lp3rmIsSi0N] succeeded
 2015-02-17 08:14:00+0000 [SSHService ssh-userauth on HoneyPotTransport,491,AAA.BBB.CCC.DDD] root authenticated with password
 2015-02-17 08:14:00+0000 [SSHService ssh-userauth on HoneyPotTransport,491,AAA.BBB.CCC.DDD] starting service ssh-connection
 2015-02-17 08:14:00+0000 [SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] got channel session request
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] channel open
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] executing command &#34;perl&#34;
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] exec command: &#34;perl&#34;
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] Opening TTY Log: log/tty/20150217-081400-01ac7460.log
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] CMD: perl
 2015-02-17 08:14:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] Command found: perl
 2015-02-17 08:34:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] remote close
 2015-02-17 08:34:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] sending request exit-status
 2015-02-17 08:34:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] Connection lost
 2015-02-17 08:34:00+0000 [SSHChannel session (0) on SSHService ssh-connection on HoneyPotTransport,491,AAA.BBB.CCC.DDD] sending close 0
 2015-02-17 08:34:00+0000 [HoneyPotTransport,491,AAA.BBB.CCC.DDD] connection lost</code></pre></div>
<p>With the existing modifications in my kippo version, the stdin of this command is now logged, as a file in the downloads directory. I&rsquo;ve made the script available below. It seems mostly to check for other rootkits inside the SSH Server and this gives some insight to a battle between different SSH bruteforcing groups.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=color:#75715e>#!/usr/bin/perl</span>
$ENV{LC_ALL} <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;C&#39;</span>; $0<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bash&#39;</span>; $ENV{<span style=color:#e6db74>&#39;PATH&#39;</span>} <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:&#39;</span><span style=color:#f92672>.</span>$ENV{<span style=color:#e6db74>&#39;PATH&#39;</span>}; $ttime1<span style=color:#f92672>=</span>time;
@mm<span style=color:#f92672>=</span>(<span style=color:#e6db74>&#34;Jan&#34;</span>,<span style=color:#e6db74>&#34;Feb&#34;</span>,<span style=color:#e6db74>&#34;Mar&#34;</span>,<span style=color:#e6db74>&#34;Apr&#34;</span>,<span style=color:#e6db74>&#34;May&#34;</span>,<span style=color:#e6db74>&#34;Jun&#34;</span>,<span style=color:#e6db74>&#34;Jul&#34;</span>,<span style=color:#e6db74>&#34;Aug&#34;</span>,<span style=color:#e6db74>&#34;Sep&#34;</span>,<span style=color:#e6db74>&#34;Oct&#34;</span>,<span style=color:#e6db74>&#34;Nov&#34;</span>,<span style=color:#e6db74>&#34;Dec&#34;</span>); <span style=color:#66d9ef>my</span>($s,$m,$h,$dm,$mm,$y,$wd,$yd,$is)<span style=color:#f92672>=</span>localtime(time);
$n_date<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;$mm[$mm] &#34;</span><span style=color:#f92672>.</span>sprintf(<span style=color:#e6db74>&#34;%2d %02d&#34;</span>,$dm,$h); $n_date <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#34;\|$mm[$mm] &#34;</span><span style=color:#f92672>.</span>sprintf(<span style=color:#e6db74>&#34;%2d %02d&#34;</span>,$dm,$h<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>if</span> ($m<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>5</span>);

$_<span style=color:#f92672>=</span><span style=color:#e6db74>`id`</span>; <span style=color:#66d9ef>if</span> (<span style=color:#f92672>~</span><span style=color:#e6db74>m/uid\=\d*?\((.*?)\)/</span>) {$u<span style=color:#f92672>=</span>$1,push(@bad_str,$1)};
<span style=color:#66d9ef>if</span> ($ENV{SSH_CLIENT} <span style=color:#f92672>=~</span><span style=color:#e6db74> /.*?(\d*\.\d*\.\d*\.\d*) /</span>) {$ip<span style=color:#f92672>=</span>$1;push(@bad_str,$1)}
<span style=color:#66d9ef>if</span> ($ENV{SSH_CONNECTION} <span style=color:#f92672>=~</span><span style=color:#e6db74> /.*?(\d*\.\d*\.\d*\.\d*) /</span>) {$ip<span style=color:#f92672>=</span>$1;push(@bad_str,$1)}
<span style=color:#66d9ef>if</span> ($ENV{SSH2_CLIENT} <span style=color:#f92672>=~</span><span style=color:#e6db74> /.*?(\d*\.\d*\.\d*\.\d*) /</span>) {$ip<span style=color:#f92672>=</span>$1;push(@bad_str,$1)}
<span style=color:#66d9ef>if</span> ($ENV{REMOTEHOST} <span style=color:#f92672>=~</span><span style=color:#e6db74> /(\d*\.\d*\.\d*\.\d*)/</span>) {$ip<span style=color:#f92672>=</span>$1;push(@bad_str,$1)}
<span style=color:#66d9ef>if</span> (exists $ENV{USER} ) { $u<span style=color:#f92672>=</span>$ENV{USER}; push(@bad_str,$u)}
<span style=color:#66d9ef>if</span> (exists $ENV{LOGNAME} ) { $u<span style=color:#f92672>=</span>$ENV{LOGNAME}; push(@bad_str,$u)}
<span style=color:#66d9ef>if</span> (exists $ENV{SUDO_USER} ) { $u<span style=color:#f92672>=</span>$ENV{SUDO_USER}; push(@bad_str,$u)}
<span style=color:#66d9ef>if</span> ($ENV{TTY} <span style=color:#f92672>=~</span> m<span style=color:#f92672>|</span><span style=color:#e6db74>/dev/</span>(<span style=color:#f92672>.*</span>)<span style=color:#f92672>|</span>) { $tty<span style=color:#f92672>=</span>$1 }; $stty<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;|grep $tty&#34;</span> <span style=color:#66d9ef>if</span> $tty;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ALERT we can&#39;t find IP in ENV\n&#34;</span> <span style=color:#66d9ef>unless</span> ($ip); <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ALERT we can&#39;t find user in ENV\n&#34;</span> <span style=color:#66d9ef>unless</span> $u;
$h<span style=color:#f92672>=</span>gethostbyaddr(pack(<span style=color:#e6db74>&#34;C4&#34;</span>,split <span style=color:#e6db74>/\./</span>,$ip),<span style=color:#ae81ff>2</span>); <span style=color:#66d9ef>if</span> ($h) { push(@bad_str,$h) } <span style=color:#66d9ef>else</span> { $h<span style=color:#f92672>=</span>$ip }

<span style=color:#66d9ef>foreach</span> (@bad_str) { $string<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;$_|&#34;</span> <span style=color:#66d9ef>unless</span> $temp{$_}; $temp{$_}<span style=color:#f92672>++</span> }
$string<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;Failed password&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;Bad strings is: &#39;$string&#39;\n&#34;</span>;

<span style=color:#75715e>#print &#34;Parse all logs.\n&#34;; #!</span>
<span style=color:#e6db74>`mkdir -p /home/tmpq`</span>; $tfile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/home/tmpq/q3def&#39;</span>;
@blist<span style=color:#f92672>=</span><span style=color:#e6db74>`find  /var/log -type f -mtime -1 -size +100M -ls`</span>; <span style=color:#66d9ef>print</span> @blist <span style=color:#66d9ef>if</span> @blist;
@logs<span style=color:#f92672>=</span><span style=color:#e6db74>`cat /etc/syslog.conf|grep -vi \&#34;#\&#34;|grep -vi dev`</span>;
<span style=color:#66d9ef>foreach</span> (@logs) {<span style=color:#66d9ef>next</span> <span style=color:#66d9ef>unless</span> <span style=color:#f92672>-</span>f $_; $logs{$1}<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span> m<span style=color:#f92672>|.*</span>?(<span style=color:#e6db74>/.+)| and not m|/m</span>ail<span style=color:#f92672>|</span> }
<span style=color:#66d9ef>foreach</span> $file (keys %logs) {
    <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> checktime($file); <span style=color:#75715e># print &#34;Check $file\n&#34;;</span>
    $system<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cat $file|egrep -i \&#34;$n_date\&#34;|egrep -i \&#34;$string\&#34;&#34;</span>; <span style=color:#75715e>#print &#34;$system\n&#34;;</span>
    $test<span style=color:#f92672>=</span><span style=color:#e6db74>`$system`</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;Found in $file. Try to correct\n&#34;</span> <span style=color:#66d9ef>if</span> $test; <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>unless</span> $test;
    $system<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cat $file|egrep -vi \&#34;$n_date\&#34;&gt;$tfile;cat $file|egrep \&#34;$n_date\&#34;|egrep -vi \&#34;$string\&#34;\&gt;&gt;$tfile;cat $tfile&gt;$file;rm -f $tfile&#34;</span>;
<span style=color:#75715e>#    print &#34;$system\n&#34;;	#!</span>
    system($system) }

<span style=color:#75715e>#print &#34;\nSearch for bad str in /var/log\n&#34;;	#!</span>
$nocheck <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;apache|munin|dcpumon|bandwidth|httpd|exim|maillog|/mail|nscd|btmp|mail\.|nginx|asterisk|iscsi|mysql|pmta|rsync|mirror|vsftpd|proftpd|php-fpm|php5-fpm|tomcat|squid|uwsgi|gammu|mrtg|chkservd|cron|rabbitmq|dovecot|quagga|access_log|roundcubemail|directadmin|redis|atop|pdns|kannel|glusterfs|/www/|powerdns|mongo|zimbra|access\.log&#39;</span>;
$system<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;find  /var/log -type f -cmin -10 -print|egrep -v &#39;$nocheck&#39;|xargs egrep -i \&#34;$ip\|$h\&#34; /dev/null|grep -vi Binary&#34;</span>;
$lpt1<span style=color:#f92672>=</span>time; @list<span style=color:#f92672>=</span><span style=color:#e6db74>`$system`</span>; $lpt2<span style=color:#f92672>=</span>time; <span style=color:#66d9ef>if</span> (($lpt2 <span style=color:#f92672>-</span> $lpt1) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span>) { printf <span style=color:#e6db74>&#34;_prof_ search time: %d min\n&#34;</span>,($lpt2 <span style=color:#f92672>-</span> $lpt1)<span style=color:#f92672>/</span><span style=color:#ae81ff>60</span> }
<span style=color:#66d9ef>foreach</span> $record (@list) { ($filename,undef)<span style=color:#f92672>=</span>split(<span style=color:#e6db74>/\:/</span>,$record); $filelist{$filename}<span style=color:#f92672>++</span> }
$i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; <span style=color:#66d9ef>foreach</span> $file (keys %filelist) {
    $i<span style=color:#f92672>++</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ALERT Bugs found in $file\n&#34;</span>;
    $system<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cat $file|egrep -vi \&#34;$ip\|$h\&#34; &gt;$tfile;cat $tfile&gt;$file;rm -f $tfile&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$system\n&#34;</span>;	<span style=color:#75715e>#!</span>
    system($system) } <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ALERT $i bugs found\n&#34;</span>;

<span style=color:#e6db74>`rm -rf /home/tmpq`</span>; $|<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;

$ttime2<span style=color:#f92672>=</span>time; <span style=color:#66d9ef>if</span> (($ttime2 <span style=color:#f92672>-</span> $ttime1) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#ae81ff>50</span>) { printf <span style=color:#e6db74>&#34;_prof_ total time: %d min\n&#34;</span>,($ttime2 <span style=color:#f92672>-</span> $ttime1)<span style=color:#f92672>/</span><span style=color:#ae81ff>60</span> }


<span style=color:#75715e>#############</span>
<span style=color:#66d9ef>my</span> $fldpr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/etc/ld.so.preload&#39;</span>; <span style=color:#66d9ef>my</span> @alert; <span style=color:#66d9ef>my</span> $al; <span style=color:#66d9ef>my</span> $alert;
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e $fldpr) { @alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`cat $fldpr`</span>; chomp @alert; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! $fldpr: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;_&#39;</span>,@alert)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>;
    $al <span style=color:#f92672>=</span> join(<span style=color:#e6db74>&#39;_&#39;</span>,@alert); <span style=color:#66d9ef>if</span> ($al <span style=color:#f92672>ne</span> <span style=color:#e6db74>&#39;/lib/libsafe.so.2&#39;</span>) { $alert<span style=color:#f92672>++</span> } }
eval { <span style=color:#66d9ef>require</span> <span style=color:#e6db74>&#39;syscall.ph&#39;</span>; <span style=color:#66d9ef>my</span> $b <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34; &#34;</span> x <span style=color:#ae81ff>10240</span>; <span style=color:#66d9ef>my</span> $f <span style=color:#f92672>=</span> syscall(<span style=color:#f92672>&amp;</span>SYS_open,$fldpr,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>); die <span style=color:#66d9ef>if</span> $f <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> syscall(<span style=color:#f92672>&amp;</span>SYS_read,$f,$b,<span style=color:#ae81ff>10240</span>);
$b <span style=color:#f92672>=</span> substr($b,<span style=color:#ae81ff>0</span>,$s); <span style=color:#66d9ef>if</span> ($s <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! HIDDEN $fldpr: open ok ($f), but read fail\n&#34;</span> }
<span style=color:#66d9ef>elsif</span> ($s <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! HIDDEN $fldpr: open ok ($f), but read 0\n&#34;</span> }
<span style=color:#66d9ef>elsif</span> (<span style=color:#f92672>!</span>$al <span style=color:#f92672>and</span> $b) { $b <span style=color:#f92672>=~</span> s<span style=color:#f92672>|\</span>n<span style=color:#f92672>|</span>_<span style=color:#f92672>|</span>g; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! HIDDEN $fldpr: $b\n&#34;</span> } syscall(<span style=color:#f92672>&amp;</span>SYS_close,$f);
<span style=color:#66d9ef>if</span> ($b <span style=color:#f92672>=~</span><span style=color:#e6db74> /\/lib\/libc\.so\.0/</span>) { $fldpr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/lib/libc.so.0&#39;</span>; <span style=color:#66d9ef>my</span> $c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34; &#34;</span> x <span style=color:#ae81ff>1024000</span>; $f <span style=color:#f92672>=</span> syscall(<span style=color:#f92672>&amp;</span>SYS_open,$fldpr,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>); die <span style=color:#66d9ef>if</span> $f <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
 $s <span style=color:#f92672>=</span> syscall(<span style=color:#f92672>&amp;</span>SYS_read,$f,$c,<span style=color:#ae81ff>1024000</span>); $c <span style=color:#f92672>=</span> substr($c,<span style=color:#ae81ff>0</span>,$s); syscall(<span style=color:#f92672>&amp;</span>SYS_close,$f); <span style=color:#66d9ef>if</span> ($c <span style=color:#f92672>=~</span><span style=color:#e6db74> /\0sshd: ([^\0]+)\0/</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! preload_pass:&#39;$1&#39;\n&#34;</span> } }
};
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/ssh/sshrc&#39;</span>) { @alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`cat /etc/ssh/sshrc`</span>; chomp @alert;  <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! /etc/ssh/sshrc: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;_&#39;</span>,@alert)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; $alert<span style=color:#f92672>++</span>; }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/root/.ssh/rc&#39;</span>)  { @alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`cat /root/.ssh/rc`</span>; chomp @alert; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! /root/.ssh/rc: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;_&#39;</span>,@alert)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; $alert<span style=color:#f92672>++</span>; }
<span style=color:#66d9ef>if</span> (exists $ENV{LD_PRELOAD})  { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! LD_PRELOAD: $ENV{LD_PRELOAD}\n&#34;</span>; $alert<span style=color:#f92672>++</span> }
<span style=color:#75715e>#print &#34;\n\tlALERT!!! no /usr/sbin/atd\n&#34; unless -e &#39;/usr/sbin/atd&#39;;</span>

$dssh <span style=color:#f92672>=</span> <span style=color:#e6db74>`ssh -G1 -V 2&gt;&amp;1 | egrep &#34;illegal|unknown&#34;`</span>; <span style=color:#66d9ef>if</span> ($? <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/bin/ssh&#39;</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! strange ssh version\n&#34;</span>; $alert<span style=color:#f92672>++</span> }
<span style=color:#66d9ef>my</span> @sfc <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep -i ForceCommand /etc/ssh/sshd_config |grep -v ^#`</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;!!! lALERT: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;&#39;</span>,@sfc) <span style=color:#66d9ef>if</span> @sfc;
@alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`lsattr /usr/sbin/sshd /usr/bin/ssh /lib/libke* /lib64/libke* 2&gt;/dev/null`</span>;
<span style=color:#66d9ef>for</span> (@alert) { <span style=color:#66d9ef>my</span> @a <span style=color:#f92672>=</span> split; $a[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> s<span style=color:#f92672>|</span>[e<span style=color:#f92672>\-</span>]<span style=color:#f92672>||</span>g; <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> $a[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;&#39;</span>;<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! lsattr:$_&#34;</span>; $alert<span style=color:#f92672>++</span>; }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>l <span style=color:#e6db74>&#39;/bin&#39;</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! /bin is link, seems like bsd jail\n&#34;</span>; }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/lib/openssh/sshd&#39;</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! strange ssh location\n&#34;</span> }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/cron.hourly/mcelog&#39;</span>)  { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! hacked reinstall script\n&#34;</span> }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/cron.hourly/verify&#39;</span>)  { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! hack md5sum checked\n&#34;</span>; $alert<span style=color:#f92672>++</span>; }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/cron.hourly/cron.sh&#39;</span>)  { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! china bot\n&#34;</span>; }
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/proc/rs_dev&#39;</span>)  { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! china rootkit\n&#34;</span>; }
@alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`ldconfig -N -X  2&gt;&amp;1`</span>; chomp(@alert); <span style=color:#66d9ef>if</span> (@alert) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! ldconfig: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@alert)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; }
@alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep -e libkey -e keyutil -e ebury -e libns -e /proc/udev -e &#34;ldd &#34; -e strace -e rootkit.sh .bash_history`</span>; chomp(@alert);
<span style=color:#66d9ef>if</span> (@alert) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! libkeysubstr: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@alert)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; $alert<span style=color:#f92672>++</span> }
@spu <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep -i AuthorizedKeysFile /etc/ssh/sshd_config|grep -v ^#|grep -wv .ssh/authorized_keys`</span>; chomp @spu;
<span style=color:#66d9ef>if</span> (@spu) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! AuthorizedKeysFile ssh: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@spu)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; $alert<span style=color:#f92672>++</span>}
@csf <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep ssh /etc/csf/csf.tempint 2&gt;/dev/null`</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! csf checksumm\n&#34;</span> <span style=color:#66d9ef>if</span> @csf;
@csf <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep ssh /var/lib/csf/csf.tempint 2&gt;/dev/null`</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! new_csf checksumm\n&#34;</span> <span style=color:#66d9ef>if</span> @csf;
@alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`ls .bash_history.cpanel_ticket.* .cpkyle.* 2&gt;/dev/null`</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! CPanel supported\n&#34;</span> <span style=color:#66d9ef>if</span> (@alert);
@alert <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep -r md5 /etc/cron.* 2&gt;/dev/null`</span>; <span style=color:#66d9ef>for</span> (@alert) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! cron_md5: $_&#34;</span> }
<span style=color:#66d9ef>if</span>    ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/debian_version&#39;</span>) { $fname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/etc/debian_version&#39;</span> }
<span style=color:#66d9ef>elsif</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/redhat-release&#39;</span>) { $fname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/etc/redhat-release&#39;</span> }
<span style=color:#66d9ef>elsif</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/gentoo-release&#39;</span>) { $fname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/etc/gentoo-release&#39;</span> }
<span style=color:#66d9ef>elsif</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/slackware-version&#39;</span>) { $fname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/etc/slackware-version&#39;</span> }
<span style=color:#66d9ef>else</span>  { $fname<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span> }

check_zbd(); check_suid(); <span style=color:#75715e>#print &#34;\n\tlALERT!!! hack1\n&#34;  if -e &#39;/usr/lib/libapt-inst-libc6.7-6.so.1.3.9&#39;;</span>
<span style=color:#66d9ef>if</span> (<span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/yum.conf&#39;</span>) { <span style=color:#66d9ef>my</span> @q<span style=color:#f92672>=</span><span style=color:#e6db74>`grep openssh /etc/yum.conf`</span>; <span style=color:#66d9ef>if</span> (@q) {<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! yum.conf: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;|&#34;</span>,@q)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> } }
<span style=color:#66d9ef>my</span> $f<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/etc/audit/audit.rules&#39;</span>; <span style=color:#66d9ef>if</span> (<span style=color:#f92672>-</span>r $f) { <span style=color:#66d9ef>my</span> $a;open($a,<span style=color:#e6db74>&#34;&lt;$f&#34;</span>); <span style=color:#66d9ef>my</span> @a<span style=color:#f92672>=</span><span style=color:#e6db74>&lt;$a&gt;</span>; close $a;chomp @a; <span style=color:#66d9ef>my</span> @aa;
<span style=color:#66d9ef>for</span> (@a) { <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> $_ <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#f92672>or</span> <span style=color:#e6db74>/^#/</span> <span style=color:#f92672>or</span> $_ <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;-D&#39;</span> <span style=color:#f92672>or</span> <span style=color:#e6db74>/^\-b\s*\d+$/</span>; push @aa,$_ }
<span style=color:#66d9ef>if</span> (@aa) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! audit: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@aa)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; $alert<span style=color:#f92672>++</span> } }

@sd <span style=color:#f92672>=</span> <span style=color:#e6db74>`strings /usr/sbin/sshd |grep -e &#34;^/usr/local/libexec&#34;`</span>;chomp @sd;<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! , &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;|&#34;</span>,@sd)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> }
<span style=color:#66d9ef>my</span> $ppid<span style=color:#f92672>=</span>getppid;<span style=color:#66d9ef>my</span> $pb<span style=color:#f92672>=</span>readlink(<span style=color:#e6db74>&#34;/proc/$ppid/exe&#34;</span>); <span style=color:#66d9ef>if</span> ($pb <span style=color:#f92672>ne</span> <span style=color:#e6db74>&#39;/usr/sbin/sshd&#39;</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! parent:$pb, $ppid\n&#34;</span>;$alert<span style=color:#f92672>++</span> }

<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ sysinfo:&#39;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ uname:&#39;</span>;system(<span style=color:#e6db74>&#39;uname -a&#39;</span>);
$dname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\n&#34;</span>; $dname <span style=color:#f92672>=</span> <span style=color:#e6db74>`echo -n &#34;$fname :&#34;;cat $fname`</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>e $fname;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ dname:&#39;</span><span style=color:#f92672>.</span>$dname;
<span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/issue&#39;</span> ) { @issue <span style=color:#f92672>=</span> <span style=color:#e6db74>`cat /etc/issue`</span>;chomp @issue }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ issue:&#39;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;_&#39;</span>,@issue)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>;
@prg <span style=color:#f92672>=</span> <span style=color:#e6db74>`which make gcc patch yum apt-get bash 2&gt;/dev/null`</span>;
<span style=color:#66d9ef>for</span> (@prg) { chomp; <span style=color:#66d9ef>if</span> (m<span style=color:#f92672>|.*/</span>(<span style=color:#f92672>.+</span>)<span style=color:#f92672>|</span>) {$prg{$1} <span style=color:#f92672>=</span> $_ } }
$dssh <span style=color:#f92672>=</span> <span style=color:#e6db74>`ssh -V 2&gt;&amp;1`</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ ssh:&#39;</span><span style=color:#f92672>.</span>$dssh;
<span style=color:#75715e>#print &#39;_#_#_ perl:&#39;.$prl || &#34;\n&#34;;</span>
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ pkg:&#39;</span><span style=color:#f92672>.</span>$prg{<span style=color:#e6db74>&#39;yum&#39;</span>}<span style=color:#f92672>.</span>$prg{<span style=color:#e6db74>&#39;apt-get&#39;</span>}<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> ;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ gcc:&#39;</span><span style=color:#f92672>.</span>$prg{<span style=color:#e6db74>&#39;gcc&#39;</span>}<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> ;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ patch:&#39;</span><span style=color:#f92672>.</span>$prg{<span style=color:#e6db74>&#39;patch&#39;</span>}<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> ;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ bash:&#39;</span><span style=color:#f92672>.</span>$prg{<span style=color:#e6db74>&#39;bash&#39;</span>}<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> ;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ zlib-dev:&#39;</span>; <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/include/zlib.h&#39;</span> ? <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> : <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ ssl-dev:&#39;</span>;  <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/include/openssl/opensslv.h&#39;</span> ? <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> : <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ pam-dev:&#39;</span>;  <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/include/security/pam_client.h&#39;</span> ? <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> : <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ krb-dev:&#39;</span>;  <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/include/krb5.h&#39;</span> ? <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> : <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ wrap-dev:&#39;</span>; <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/usr/include/tcpd.h&#39;</span> ? <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> : <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span>;
@w<span style=color:#f92672>=</span><span style=color:#e6db74>`w`</span>; <span style=color:#66d9ef>for</span> (@w) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ who:&#39;</span><span style=color:#f92672>.</span>$_ }

<span style=color:#66d9ef>my</span> $lf<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;libkeyutils.so.1&#39;</span>;<span style=color:#66d9ef>for</span> (<span style=color:#e6db74>qw{/lib /lib64 /lib/x86_64-linux-gnu /lib/i386-linux-gnu}</span>) { <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#34;$_/$lf&#34;</span> <span style=color:#f92672>&amp;&amp;</span> system(<span style=color:#e6db74>&#34;ls -l $_/$lf;ls -lL $_/$lf&#34;</span>) }

$prl <span style=color:#f92672>=</span> <span style=color:#e6db74>`file -L \`which perl\``</span>; $wgt <span style=color:#f92672>=</span> <span style=color:#e6db74>`file -L \`which wget\``</span>;
<span style=color:#66d9ef>if</span> ($prl <span style=color:#f92672>!~</span> <span style=color:#e6db74>/, stripped/</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tALERT!!! perl:$prl&#34;</span> } <span style=color:#66d9ef>if</span> ($wgt <span style=color:#f92672>!~</span> <span style=color:#e6db74>/, stripped/</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! wget:$wgt&#34;</span> }
<span style=color:#66d9ef>my</span> @binssh <span style=color:#f92672>=</span> <span style=color:#e6db74>`file /usr/bin/ssh /usr/sbin/sshd`</span>; <span style=color:#66d9ef>for</span> (@binssh) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! ssh-bin:$_&#34;</span> <span style=color:#66d9ef>unless</span> <span style=color:#e6db74>/, stripped/</span> <span style=color:#f92672>and</span> <span style=color:#e6db74>/LSB  ?shared object/</span> }

<span style=color:#66d9ef>my</span> @pamlib; <span style=color:#66d9ef>for</span> (<span style=color:#e6db74>&#39;/lib64/security/pam_unix.so&#39;</span>,<span style=color:#e6db74>&#39;/lib/security/pam_unix.so&#39;</span>) { push @pamlib,$_ <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>e $_}
<span style=color:#66d9ef>my</span> @plo <span style=color:#f92672>=</span> <span style=color:#e6db74>`file @pamlib`</span>; <span style=color:#66d9ef>for</span> (@plo) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! pam-bin:$_&#34;</span> <span style=color:#66d9ef>unless</span> <span style=color:#e6db74>/, stripped/</span> }
<span style=color:#66d9ef>for</span> (@pamlib) { local $/ <span style=color:#f92672>=</span> undef; open(IN,<span style=color:#e6db74>&#34;&lt;$_&#34;</span>); <span style=color:#66d9ef>my</span> $plo <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;IN&gt;</span>; close IN; <span style=color:#66d9ef>my</span> @plo <span style=color:#f92672>=</span> ($plo <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{4,})/g</span>);
<span style=color:#66d9ef>my</span> @pls <span style=color:#f92672>=</span> pgrep(<span style=color:#f92672>\</span>@plo,<span style=color:#e6db74>&#39;-UN\*X-PASS&#39;</span>,<span style=color:#e6db74>&#39;-A 2&#39;</span>); <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> $pls[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^auth could not identify/</span> <span style=color:#f92672>or</span> $pls[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;Password: &#39;</span> <span style=color:#f92672>or</span> $pls[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;&#39;</span>;
<span style=color:#66d9ef>if</span> ($pls[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>!~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\nmod_ssh_pam1: &#39;$pls[1]&#39; $_\n&#34;</span> } <span style=color:#66d9ef>else</span> {
  <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\nmod_ssh_pam2: $_: &#39;$pls[4]&#39; pass:&#39;$pls[3]&#39;; file:&#39;$pls[1]&#39;\n&#34;</span>;system(<span style=color:#e6db74>&#34;ls -l $pls[1] ;cat $pls[1]&#34;</span>) <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>e $pls[<span style=color:#ae81ff>1</span>] } }

<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\n&#34;</span>; system(<span style=color:#e6db74>&#39;id;df -h;wc -l .ssh/known_hosts&#39;</span>);
$prf <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/etc/profile ~/.bash_profile ~/.bash_login ~/.profile /etc/bash.bashrc /etc/bashrc ~/.bashrc /etc/profile.d/* 2&gt;/dev/null &#39;</span>;
$prfg <span style=color:#f92672>=</span>  <span style=color:#e6db74>&#39; |fgrep -v -e /complete. -e profile.d/profile -e /bindkey. -e /limits. -e /locallib. -e /lang. -e &#34;:# &#34; -e LESS &#39;</span>;
$prfg <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39; -e &#34;MAIL=&#34; -e mc-wrapper -e SSH_ASKPASS -e lesspipe -e &#34;/etc/profile.d/*.sh&#34; &#39;</span>;
system(<span style=color:#e6db74>&#39;fgrep -e trap -e mail -e who -e exec -e logger -e php -e perl -e ssbutil -e \.sh -e script &#39;</span><span style=color:#f92672>.</span>$prf<span style=color:#f92672>.</span>$prfg);
system(<span style=color:#e6db74>&#39;grep -i hist &#39;</span><span style=color:#f92672>.</span>$prf<span style=color:#f92672>.</span><span style=color:#e6db74>&#39; |grep -v -e &#34;:#&#34; -e HISTCONTROL -e histappend -e /complete. -e /bindkey.&#39;</span>);
system(<span style=color:#e6db74>&#39;grep @ /etc/syslog.conf /etc/rsyslog.conf 2&gt;/dev/null&#39;</span>);
system(<span style=color:#e6db74>&#39;grep destination /etc/syslog-ng.conf /etc/syslog-ng/syslog-ng.conf 2&gt;/dev/null |grep -e tcp -e udp&#39;</span>);

<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;bin_md5_sum: \n&#34;</span>;<span style=color:#66d9ef>my</span> $md5d;<span style=color:#66d9ef>my</span> $md5c; <span style=color:#75715e>#system(&#39;md5sum /usr/sbin/sshd /usr/bin/ssh&#39;);</span>
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>md5_file</span> { <span style=color:#66d9ef>my</span> $f <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $fp; open($fp,<span style=color:#e6db74>&#34;&lt;$f&#34;</span>) <span style=color:#f92672>or</span> die <span style=color:#e6db74>&#34;Can&#39;t open &#39;$f&#39;: $!&#34;</span>;
binmode($fp); <span style=color:#66d9ef>my</span> $md5 <span style=color:#f92672>=</span> Digest::MD5<span style=color:#f92672>-&gt;</span><span style=color:#66d9ef>new</span><span style=color:#f92672>-&gt;</span>addfile($fp)<span style=color:#f92672>-&gt;</span>hexdigest; close $fp; <span style=color:#66d9ef>return</span> $md5 }
eval { <span style=color:#66d9ef>require</span> Digest::MD5; $md5d <span style=color:#f92672>=</span> md5_file(<span style=color:#e6db74>&#39;/usr/sbin/sshd&#39;</span>); $md5c <span style=color:#f92672>=</span> md5_file(<span style=color:#e6db74>&#39;/usr/bin/ssh&#39;</span>);
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$md5d  /usr/sbin/sshd\n$md5c  /usr/bin/ssh\n&#34;</span>}; <span style=color:#66d9ef>if</span> ($@) { system(<span style=color:#e6db74>&#39;md5sum /usr/sbin/sshd /usr/bin/ssh&#39;</span>) }

<span style=color:#66d9ef>my</span> @rpl <span style=color:#f92672>=</span> <span style=color:#e6db74>`rpm -qV openssh-server openssh-clients openssh pam 2&gt;/dev/null |fgrep -v -e &#39; c &#39; -e &#39;  d &#39; -e &#39;.......T&#39;;rpm -qv openssh-server openssh-clients openssh openssh-askpass fipscheck keyutils-libs`</span>;
<span style=color:#66d9ef>if</span> (@rpl) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\nRPM check:\n&#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;&#39;</span>,@rpl)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\nDEB check: &#34;</span>; <span style=color:#66d9ef>my</span> $debsc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/var/lib/dpkg/info&#39;</span>; <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#34;$debsc/openssh-server.md5sums&#34;</span> ) {
  @rpl <span style=color:#f92672>=</span> <span style=color:#e6db74>`cd /;md5sum -c $debsc/openssh-server.md5sums $debsc/openssh-client.md5sums $debsc/libpam-modules*.md5sums 2&gt;&amp;1 |grep -v &#39;: OK\$&#39;`</span>;
<span style=color:#66d9ef>if</span> (@rpl) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;&#39;</span>,@rpl)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> } <span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;ok\n&#34;</span> } } <span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;no deb sums found\n&#34;</span> }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;_#_#_ ifconfig:&#39;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>;<span style=color:#66d9ef>my</span> @if <span style=color:#f92672>=</span> <span style=color:#e6db74>`ifconfig 2&gt;/dev/null |grep inet`</span>; <span style=color:#66d9ef>for</span> (@if) { s<span style=color:#f92672>|</span> Bcast:<span style=color:#f92672>.*||</span>; s<span style=color:#f92672>|</span> netmask <span style=color:#f92672>.*||</span> }
<span style=color:#66d9ef>print</span> join(<span style=color:#e6db74>&#39;&#39;</span>,@if)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;_#_#_ ifconfig_end\n&#34;</span>;

<span style=color:#66d9ef>my</span> %pw <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;/usr/include/gpm2.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/lib/initr&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,<span style=color:#e6db74>&#39;/usr/include/symc.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,<span style=color:#e6db74>&#39;/usr/include/pwd2.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,<span style=color:#e6db74>&#39;/var/lib/nfs/gpm2.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/share/sshd.sync&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/rescue/mount_fs&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/libiconv.so.0&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/share/man/mann/options&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/etc/ssh/.sshd_auth&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/.sshd.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/kix.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/pthread2x.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/tmp/.lost+found&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/lib/jlib.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/zaux.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/local/include/uconf.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/netda.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/include/zconf2.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/libm.c&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/etc/gpufd&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/syslog2.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/.options&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/include/lwpin.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/libsplug.2.so&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/dev/devno&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/ncurse.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/linux/byteorder/ssh.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/include/client.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/linux/byteorder/ssh.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/log//.login&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/ofed/bin/bin&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/ofed/bin/ssh&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/lib/libsplug.4.so&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/share/core.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/games/.blane&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/tmp/.ICE-unix/error.log&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/.sshd.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/include/filearch.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/usr.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/html/lol&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/etc/listpr&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/share/boot.sync&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/include/true.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/npss.state&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/.ssh.pid&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/libQtNetwork.so.4.0.1&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/lib/libgssapi_krb5.so.9.9&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/etc/security/pam_env&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/lib/rpm/rpm.cx&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#75715e># binary</span>
<span style=color:#e6db74>&#39;/usr/include/boot.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/linux/arp.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/libssh.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/linux/boot.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/games/.lost+found&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/proc.pid&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/lvm//lvm.pid&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/usr/include/linux/netfilter/ssh.h&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/usr/lib/libtools.x&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#e6db74>&#39;/var/run/+++screen.run&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;/var/run/+++php.run&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>,
<span style=color:#75715e># non-passwd, files from sshd_str</span>
<span style=color:#e6db74>&#39;/usr/libexec/ssh-keysign&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;/bin/passwd&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;/dev/zero&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;/dev/null&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;/dev/urandom&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;/dev/random&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>
<span style=color:#75715e># usermode rootkit &#39;/usr/include/file.h&#39; =&gt; 0, &#39;/etc/sh.conf&#39; =&gt; 0</span>
);

<span style=color:#66d9ef>my</span> $bsshd; <span style=color:#66d9ef>my</span> $bssh; <span style=color:#66d9ef>my</span> @bsshd; <span style=color:#66d9ef>my</span> @bssh; check_binary() <span style=color:#66d9ef>unless</span> md5checkd(); <span style=color:#75715e>#check_rootkit();</span>
<span style=color:#66d9ef>for</span> (keys %pw) { dump_passwd($_) }
system(<span style=color:#e6db74>&#34;ls -l /etc/sh.conf;cat /etc/sh.conf&#34;</span>) <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>e <span style=color:#e6db74>&#39;/etc/sh.conf&#39;</span>;
system(<span style=color:#e6db74>&#34;sestatus |grep status 2&gt;/dev/null&#34;</span>);

<span style=color:#66d9ef>if</span> ($alert) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;alert:&#39;$alert&#39;; exit\n&#34;</span>; exit }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>check_suid</span> { <span style=color:#66d9ef>my</span> @sl <span style=color:#f92672>=</span> <span style=color:#e6db74>`find /bin /usr/bin -perm -4000;`</span>; chomp @sl; <span style=color:#66d9ef>my</span> $s;
<span style=color:#66d9ef>if</span>    ($fname <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;/etc/redhat-release&#39;</span>) { $s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;rpm -qf &#39;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39; &#39;</span>,@sl)<span style=color:#f92672>.</span><span style=color:#e6db74>&#39; |grep ^file&#39;</span> }
<span style=color:#66d9ef>elsif</span> ($fname <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;/etc/debian_version&#39;</span>) { $s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;dpkg -S &#39;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39; &#39;</span>,@sl)<span style=color:#f92672>.</span><span style=color:#e6db74>&#39; 2&gt;&amp;1 |grep ^dpkg:&#39;</span> }
<span style=color:#66d9ef>else</span> { $s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ls -al &#39;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39; &#39;</span>,@sl)<span style=color:#f92672>.</span><span style=color:#e6db74>&#39; 2&gt;&amp;1&#39;</span> } <span style=color:#66d9ef>my</span> @s <span style=color:#f92672>=</span> <span style=color:#e6db74>`$s`</span>; <span style=color:#66d9ef>for</span> (@s) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\tlALERT!!! suid:$_&#34;</span> } }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>check_zbd</span> { <span style=color:#66d9ef>my</span> @f<span style=color:#f92672>=</span><span style=color:#e6db74>qw{/bin/delp /usr/bin/zmuie /bin/zcut /etc/cron.weekly/ssh-copy /etc/cron.weekly/dnsquery
</span><span style=color:#e6db74> /usr/lib/autom4te.cache.lib /usr/lib/libapt-inst-libc6.7-6.so.1.3.9 /usr/lib/libgssapi_krb5.so.9.9 }</span>;
<span style=color:#66d9ef>my</span> $u <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;grep -e ^bin:x: -e ^lp:x: -e ^syslog /etc/passwd |grep bash; grep -e ^bin:\\\$ -e ^lp:\\\$ -e ^syslog:\\\$ /etc/shadow&#39;</span>;
<span style=color:#66d9ef>my</span> @u <span style=color:#f92672>=</span> <span style=color:#e6db74>`$u`</span>; <span style=color:#66d9ef>my</span> @c <span style=color:#f92672>=</span> <span style=color:#e6db74>`grep -r zmuie /etc/cron* 2&gt;/dev/null`</span>;
<span style=color:#66d9ef>for</span> (@f) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! zbdoor:$_\n&#34;</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>e $_ } <span style=color:#66d9ef>for</span>(@u,@c) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! zbdoor:$_&#34;</span> } }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>dump_passwd</span> { <span style=color:#66d9ef>my</span> $f<span style=color:#f92672>=</span>shift; <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> $pw{$f}; $pw{$f}<span style=color:#f92672>++</span>; <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>unless</span> <span style=color:#f92672>-</span>f $f; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_str_ : &#34;</span>;system(<span style=color:#e6db74>&#34;ls -l &#39;$f&#39;&#34;</span>);
<span style=color:#66d9ef>my</span> $fn; open($fn,<span style=color:#e6db74>&#34;&lt;$f&#34;</span>); read($fn,$fc,<span style=color:#ae81ff>1024</span><span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>); close $fn; <span style=color:#66d9ef>if</span> ($fc <span style=color:#f92672>!~</span> <span style=color:#e6db74>/[\x00-\x08\x0B-\x1F\x7F-\xFF]/</span>) { system(<span style=color:#e6db74>&#34;tail -n 20000 &#39;$f&#39;&#34;</span>) }
<span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>my</span> @q<span style=color:#f92672>=</span>unpack(<span style=color:#e6db74>&#39;C*&#39;</span>,$fc);<span style=color:#66d9ef>for</span> (@q) { $_ <span style=color:#f92672>=</span> chr((<span style=color:#f92672>~</span> $_) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xff</span>) } $fc<span style=color:#f92672>=</span>join(<span style=color:#e6db74>&#39;&#39;</span>,@q);
<span style=color:#66d9ef>if</span> ($fc <span style=color:#f92672>=~</span><span style=color:#e6db74> /[\x00-\x08\x0B-\x1F\x7F-\xFF]/</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$f : crypted, skip\n&#34;</span>; <span style=color:#66d9ef>return</span> }
open($fn,<span style=color:#e6db74>&#34;&lt;$f&#34;</span>);seek($fn,<span style=color:#f92672>-</span><span style=color:#ae81ff>400</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1024</span>,<span style=color:#ae81ff>2</span>); <span style=color:#66d9ef>while</span>(read($fn,$fc,<span style=color:#ae81ff>1</span>)) { <span style=color:#66d9ef>print</span> (<span style=color:#f92672>~</span> $fc) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xff</span> } close $fn; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n&#34;</span> } }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>checktime</span> { <span style=color:#66d9ef>return</span> (time<span style=color:#f92672>-</span>(stat(shift))[<span style=color:#ae81ff>9</span>])<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>60</span><span style=color:#f92672>*</span><span style=color:#ae81ff>10</span> } <span style=color:#75715e># true if (curr time &gt; file mod time) more then 60*10 second</span>
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>ssh_ls</span> { <span style=color:#66d9ef>for</span>(@_) { dump_passwd($_) } <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> $sshls; system(<span style=color:#e6db74>&#39;ls -al /usr/bin/ssh* /usr/sbin/ssh* &#39;</span>); $sshls<span style=color:#f92672>++</span> }
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>pgrep</span> { <span style=color:#66d9ef>my</span> $a <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $p <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> @out; <span style=color:#66d9ef>my</span> @idx;
    <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>scalar @{$a}) { push @idx,$_ <span style=color:#66d9ef>if</span> ($a)<span style=color:#f92672>-&gt;</span>[$_] <span style=color:#f92672>=~</span><span style=color:#e6db74> /$s/</span> }
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>unless</span> @idx;
    <span style=color:#66d9ef>my</span> $min; <span style=color:#66d9ef>my</span> $max; <span style=color:#66d9ef>my</span> @p <span style=color:#f92672>=</span> split(<span style=color:#e6db74>/\s+/</span>,$p);
    <span style=color:#66d9ef>while</span>(@p) { <span style=color:#66d9ef>my</span> $t <span style=color:#f92672>=</span> shift @p;
	<span style=color:#66d9ef>if</span> ($t <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;-B&#39;</span>) { $min <span style=color:#f92672>=</span> shift @p} <span style=color:#66d9ef>elsif</span> ($t <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;-A&#39;</span>) { $max <span style=color:#f92672>=</span> shift @p} <span style=color:#66d9ef>elsif</span> ($t <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;-C&#39;</span>) { $min <span style=color:#f92672>=</span> shift @p; $max <span style=color:#f92672>=</span> $min }
	<span style=color:#66d9ef>else</span> { warn <span style=color:#e6db74>&#34;perl_strings: wrong param: &#39;$t@p&#39;\n&#34;</span>; <span style=color:#66d9ef>last</span> } }
    <span style=color:#66d9ef>my</span> $idx <span style=color:#f92672>=</span> shift @idx; <span style=color:#66d9ef>if</span> (@idx) { warn <span style=color:#e6db74>&#34;&#39;$s&#39; - multipattern !!!\n&#34;</span> }
    <span style=color:#66d9ef>if</span> (defined $min) { $min <span style=color:#f92672>=</span> $idx <span style=color:#f92672>-</span> $min } <span style=color:#66d9ef>else</span> { $min <span style=color:#f92672>=</span> $idx } <span style=color:#66d9ef>if</span> (defined $max) { $max <span style=color:#f92672>=</span> $idx <span style=color:#f92672>+</span> $max } <span style=color:#66d9ef>else</span> { $max <span style=color:#f92672>=</span> $idx }
<span style=color:#75715e>#printf &#34;&#39;%s&#39;,&#39;%s&#39;: %d: %s\n&#34;,$s,$p,$idx,join(&#34;,&#34;,$min..$max);</span>
    <span style=color:#66d9ef>for</span> ($min<span style=color:#f92672>..</span>$max) { push @out,($a)<span style=color:#f92672>-&gt;</span>[$_] }
    <span style=color:#66d9ef>return</span> @out;
}
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>gs</span> { <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $p <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>return</span> pgrep(<span style=color:#f92672>\</span>@bsshd,$s,$p) }
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>gc</span> { <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $p <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>return</span> pgrep(<span style=color:#f92672>\</span>@bssh, $s,$p) }
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>load_bin</span> { local $/ <span style=color:#f92672>=</span> undef;
open(IN,<span style=color:#e6db74>&#34;&lt;/usr/sbin/sshd&#34;</span>) <span style=color:#f92672>or</span> warn <span style=color:#e6db74>&#34;perl_strings: can&#39;t open sshd\n&#34;</span>;$bsshd <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;IN&gt;</span>; close IN; @bsshd <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{4,})/g</span>);
open(IN,<span style=color:#e6db74>&#34;&lt;/usr/bin/ssh&#34;</span>)   <span style=color:#f92672>or</span> warn <span style=color:#e6db74>&#34;perl_strings: can&#39;t open ssh\n&#34;</span>; $bssh  <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;IN&gt;</span>; close IN; @bssh  <span style=color:#f92672>=</span> ($bssh  <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{4,})/g</span>); }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>check_rootkit</span> { <span style=color:#66d9ef>my</span> $PROCFS_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/proc/modules&#34;</span>;<span style=color:#66d9ef>my</span> $SYSFS_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/sys/module&#34;</span>;
<span style=color:#66d9ef>my</span> @mod_procfs<span style=color:#f92672>=</span><span style=color:#e6db74>`cat $PROCFS_PATH | cut -d&#39; &#39; -f1 | sort -d`</span>; chomp @mod_procfs;
<span style=color:#66d9ef>my</span> @mod_sysfs<span style=color:#f92672>=</span><span style=color:#e6db74>`find $SYSFS_PATH -name refcnt | cut -d&#39;/&#39; -f4 | sort -d`</span>; chomp @mod_sysfs;
<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>unless</span> @mod_procfs <span style=color:#f92672>and</span> @mod_sysfs; <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> scalar @mod_procfs <span style=color:#f92672>==</span> scalar @mod_sysfs;
<span style=color:#66d9ef>my</span> %h; <span style=color:#66d9ef>for</span> (@mod_procfs) { $h{$_}<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> }
<span style=color:#66d9ef>for</span> (@mod_sysfs) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;__unknown_mod: &#39;$_&#39;\n&#34;</span> <span style=color:#66d9ef>unless</span> exists $h{$_} }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! tclpz detected&#34;</span> <span style=color:#66d9ef>if</span> grep <span style=color:#e6db74>/^tclpz/</span>,@mod_procfs;
}
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>mod_gen</span> { <span style=color:#66d9ef>if</span> (index($bsshd,<span style=color:#e6db74>&#39;read_server_config&#39;</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_gen0: old_ssh_version\n&#34;</span> }
<span style=color:#66d9ef>my</span> $q <span style=color:#f92672>=</span> index($bsshd,<span style=color:#e6db74>&#39;trying public RSA key file &#39;</span>); <span style=color:#66d9ef>if</span> ($q <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_gen1: string not found\n&#34;</span>; <span style=color:#66d9ef>return</span> }
<span style=color:#66d9ef>my</span> $q1 <span style=color:#f92672>=</span> substr($bsshd,$q<span style=color:#f92672>-</span><span style=color:#ae81ff>2000</span>,<span style=color:#ae81ff>2000</span>); <span style=color:#66d9ef>my</span> $q2 <span style=color:#f92672>=</span> substr($bsshd,$q<span style=color:#f92672>-</span><span style=color:#ae81ff>10000</span>,<span style=color:#ae81ff>10000</span>);
<span style=color:#66d9ef>unless</span> ($q1 <span style=color:#f92672>=~</span><span style=color:#e6db74> /xx\0+(.*)$/s</span> <span style=color:#f92672>||</span> $q2 <span style=color:#f92672>=~</span><span style=color:#e6db74> /xx\0+(.*)$/s</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_gen1: pattern not found!!!!\n&#34;</span>; <span style=color:#66d9ef>return</span> }
<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> $1 <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#66d9ef>my</span> @z <span style=color:#f92672>=</span> ($1 <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{2,})/g</span>);
<span style=color:#66d9ef>if</span> ($q1 <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{3,32})\0xx\0+.*$/s</span>) { push @z,$1 }
<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> $z[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;auth_rsa_generate_challenge: BN_new() failed&#39;</span>; <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> $z[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /\[LDAP\] /</span>;
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_gen1: &#39;&#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@z)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39;\n&#34;</span>; }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>check_binary</span> { <span style=color:#66d9ef>my</span> @sd; <span style=color:#66d9ef>my</span> @sc; load_bin(); mod_gen();
<span style=color:#66d9ef>if</span> ($dssh <span style=color:#f92672>=~</span> m<span style=color:#f92672>|</span>, SSH protocols <span style=color:#ae81ff>1.5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2.0</span>, <span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_ssh: \n&#34;</span>;
    @sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s : %s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s : %s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);
    <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span> ) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd01: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;\nmod_sshc01: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>1</span>]) }
    @sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);
    <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span> ) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd02: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;\nmod_sshc02: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>1</span>]) }
}

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;libo&#39;</span>); <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! libo sshd detected\n&#34;</span> <span style=color:#66d9ef>if</span> (@sd);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;libo&#39;</span>); <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;\n\tlALERT!!! libo ssh  detected\n&#34;</span> <span style=color:#66d9ef>if</span> (@sd);
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;SSH-1.5-W1.0&#39;</span>,<span style=color:#e6db74>&#39;-A 15&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;mkdir -p %s&#39;</span>,<span style=color:#e6db74>&#39;-A 2&#39;</span>);
<span style=color:#66d9ef>if</span> (@sc <span style=color:#f92672>or</span> $sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd1: &#39;$sd[1]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc1: &#39;$sc[1]&#39;:&#39;$sc[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>2</span>]) }
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd1a: file:&#39;$sd[4]&#39;; hash:&#39;$sd[15]&#39;; cvs:&#39;$sd[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>4</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;\.rhosts&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd2: &#39;$sd[1]&#39;:&#39;$sd[2]&#39;:&#39;$sd[3]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;/usr/share/man/mann/options&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;/usr/share/man/mann/options&#39;</span>);
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> $k; <span style=color:#66d9ef>my</span> @s;
    @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;apac&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^apache!s/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^status-o/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;apac&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;stat&#39;</span>);
    @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;GftR&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^GftRudW!/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^pezdecov/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;GftR&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;pezd&#39;</span>);
    @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;dont&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^dontxekm/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^superhos/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dont&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;supe&#39;</span>);
    @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;IAd5&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> <span style=color:#e6db74>&#39;repo&#39;</span> <span style=color:#f92672>or</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> <span style=color:#e6db74>&#39;repo&#39;</span>);
    @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;3Oje&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span> <span style=color:#66d9ef>if</span> map <span style=color:#e6db74>/^repo/</span>,@s;
    printf <span style=color:#e6db74>&#34;mod_sshd03: $sd[0]; known: %d\n&#34;</span>,$k; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>my</span> $k; <span style=color:#66d9ef>my</span> @s;
    @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;apac&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^apache!s/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^status-o/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;apac&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;stat&#39;</span>);
    @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;GftR&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^GftRudW!/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^pezdecov/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;GftR&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;pezd&#39;</span>);
    @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;dont&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^dontxekm/</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^superhos/</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dont&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;supe&#39;</span>);
    @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;IAd5&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> <span style=color:#e6db74>&#39;repo&#39;</span> <span style=color:#f92672>or</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> <span style=color:#e6db74>&#39;repo&#39;</span>);
    @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;3Oje&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); $k<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span> <span style=color:#66d9ef>if</span> map <span style=color:#e6db74>/^repo/</span>,@s;
    printf <span style=color:#e6db74>&#34;mod_sshc03: $sc[0]; known: %d\n&#34;</span>,$k; ssh_ls($sc[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;Sshd password detected&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;User %s connecting as %s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>);
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc4: &#39;$sc[1]&#39;:&#39;$sc[0]&#39;\n&#34;</span> <span style=color:#66d9ef>if</span> @sc <span style=color:#f92672>and</span> $sc[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/|; if ($sd[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd4: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>])}
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;trying public RSA key file %s&#39;</span>,<span style=color:#e6db74>&#39;-B 6&#39;</span>);  <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd5: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@sd)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39; %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39; %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd6: &#39;$sd[2]&#39;:&#39;$sd[0]&#39;\nmod_sshc6: &#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;SSH-1.5-W1.0&#39;</span>,<span style=color:#e6db74>&#39;-B 5&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;mkdir -p %s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd7: &#39;$sd[0]&#39;:&#39;$sd[4]&#39;\nmod_sshc7: &#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>4</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;user: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;user: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd8: &#39;$sd[1]&#39;:&#39;$sd[2]&#39;\nmod_sshc8: &#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;user: %s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;user: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 20&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd9: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\nmod_sshc9: &#39;$sc[20]&#39;:&#39;$sc[19]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>20</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-B 2 -A 9&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-B 2 -A 10&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>11</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd10: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[11]&#39;\nmod_sshc10: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;:&#39;$sc[12]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>11</span>],$sc[<span style=color:#ae81ff>12</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;incoming : %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;mkdir -p %s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd11: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\nmod_sshc11: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;pwd:+%.64s+%.64s+%.64s&#39;</span>);<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd12: GET, no params&#34;</span>; ssh_ls() }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 3&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s:%s@%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| and $sd[2] =~ m|^/</span><span style=color:#f92672>|</span>) {
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd13: hash:&#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\nmod_sshc13: hash:&#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>;ssh_ls($sd[<span style=color:#ae81ff>2</span>])}
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-A 4&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-A 4&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd14: hash:&#39;$sd[3]&#39;:&#39;$sd[4]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc14: hash:&#39;$sd[3]&#39;:&#39;$sd[4]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>2</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-A 11&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-A 12&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) {
<span style=color:#66d9ef>my</span> $hp; <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>5</span><span style=color:#f92672>..</span><span style=color:#ae81ff>15</span>) { <span style=color:#66d9ef>if</span> ($sd[$_] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^\$1\$/</span> <span style=color:#f92672>and</span> (length $sd[$_] <span style=color:#f92672>==</span> <span style=color:#ae81ff>30</span>)) { $hp <span style=color:#f92672>=</span> $sd[$_]; <span style=color:#66d9ef>last</span> } }
<span style=color:#66d9ef>if</span> ($hp) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd14: hash:&#39;$hp&#39;; fpass:&#39;$sd[1]&#39;;&#39;$sd[3]&#39;\nmod_sshc14: hash:&#39;$sd[4]&#39;; fpass:&#39;$sd[1]&#39;;&#39;$sd[3]&#39;\n&#34;</span>; }
<span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd14: unknown hash; fpass:&#39;$sd[1]&#39;;&#39;$sd[3]&#39;\n&#34;</span> } ssh_ls($sd[<span style=color:#ae81ff>3</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;Inbound: %s %s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;Outbound: %s %s %s&#39;</span>,<span style=color:#e6db74>&#39;-B 39&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd15: &#39;$sd[0]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc15: &#39;$sc[38]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>2</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;sshd password detected: %s@%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;User %s, connecting as %s@%s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd16: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc16: &#39;$sc[1]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;mkdir -p %s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;mkdir -p %s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd17: crypt:&#39;$sd[2]&#39;:&#39;$sd[0]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc17: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>;
    <span style=color:#66d9ef>my</span> @q<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;SSH-1.5-W1.0&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>); <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd17: client_string:&#39;$q[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;SSH AGENT&#39;</span>,<span style=color:#e6db74>&#39;-C 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;SSH AGENT&#39;</span>,<span style=color:#e6db74>&#39;-C 2&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd18: md5:&#39;$sd[3]&#39;:&#39;$sd[0]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc18: md5:&#39;$sc[3]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;/usr/bin/curl&#39;</span>,<span style=color:#e6db74>&#39;-C 3&#39;</span>);<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd19: &#39;$sd[0]&#39;:&#39;$sd[1]&#39; url:&#39;$sd[5] &#39;$sd[4]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;login in: %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;login at: %s %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd20: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc20: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>1</span>]) }
@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;outgoing : %s %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sd<span style=color:#f92672>=</span>gs($sc[<span style=color:#ae81ff>0</span>]) <span style=color:#66d9ef>if</span> $sc[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>;
<span style=color:#66d9ef>if</span> ($sc[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span> <span style=color:#f92672>and</span> @sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd21: &#39;$sd[0]&#39; mod_sshc21: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sc[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;user:password --&gt; %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);<span style=color:#75715e>#@sc=gc();</span>
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc22: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;From: %s - %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;To: %s - %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd23: &#39;$sd[2]&#39;:&#39;$sd[0]&#39;\n&#34;</span>; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc23: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>],$sc[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;rcpt to: &#39;</span>,<span style=color:#e6db74>&#39;-B 21&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;ssh: av\[%d\]: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>17</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[1] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd24: &#39;$sd[0]&#39;:&#39;$sd[17]&#39;:&#39;$sd[18]:$sd[20]&#39;\n&#34;</span>;
 <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc24: &#39;$sc[1]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>17</span>],$sc[<span style=color:#ae81ff>1</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;&lt; %s %s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;&gt; %s %s %s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd25: &#39;$sd[2]&#39;:&#39;$sd[0]&#39; mod_sshc25: &#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>],$sc[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;GET /\?sid=&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span>GET <span style=color:#f92672>|</span> <span style=color:#f92672>or</span> @sc) { <span style=color:#66d9ef>my</span> @sd1<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;f:p:b:k:h:g:u:o:dDeiqrtQR46&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>); <span style=color:#66d9ef>my</span> @sc1<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;clear hostkey %d&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
 <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd26: &#39;$sd[0]&#39;:&#39;$sd[2]&#39;:&#39;$sd1[0]&#39; mod_sshc26: &#39;$sc[0]&#39;:&#39;$sc1[0]&#39;\n&#34;</span>; ssh_ls() }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 3&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s@%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> (($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| and $sd[1] =~ /</span><span style=color:#f92672>^</span>cat <span style=color:#e6db74>/) or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd27: &#39;$sd[0]&#39;:&#39;$sd[2]&#39;:&#39;$sd[1]&#39;\nmod_sshc27: &#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>2</span>],$sc[<span style=color:#ae81ff>0</span>]) }
<span style=color:#75715e>#</span>
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;/var/log/httpd-access.log&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;/var/log/httpd-access.log&#39;</span>);
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> @xbin1 <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x01-\x7e]{6,})/g</span>); <span style=color:#66d9ef>my</span> @xbin2; <span style=color:#66d9ef>foreach</span> <span style=color:#66d9ef>my</span> $q (@xbin1) { <span style=color:#66d9ef>my</span> $xbin <span style=color:#f92672>=</span> $q<span style=color:#f92672>^</span> chr(<span style=color:#ae81ff>0x23</span>) x length $q;
push @xbin2,($xbin <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{6,})/g</span>) } @sd <span style=color:#f92672>=</span> pgrep(<span style=color:#f92672>\</span>@xbin2,<span style=color:#e6db74>&#39;id=%s&amp;m=%s&#39;</span>,<span style=color:#e6db74>&#39;-B 3&#39;</span>) }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>my</span> @xbin1 <span style=color:#f92672>=</span> ($bssh <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x01-\x7e]{6,})/g</span>); <span style=color:#66d9ef>my</span> @xbin2; <span style=color:#66d9ef>foreach</span> <span style=color:#66d9ef>my</span> $q (@xbin1) { <span style=color:#66d9ef>my</span> $xbin <span style=color:#f92672>=</span> $q<span style=color:#f92672>^</span> chr(<span style=color:#ae81ff>0x23</span>) x length $q;
push @xbin2,($xbin <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x09\x20-\x7e]{6,})/g</span>) } @sc <span style=color:#f92672>=</span> pgrep(<span style=color:#f92672>\</span>@xbin2,<span style=color:#e6db74>&#39;id=%s&amp;m=%s&#39;</span>,<span style=color:#e6db74>&#39;-B 3&#39;</span>) }
<span style=color:#66d9ef>if</span> (@sd <span style=color:#f92672>or</span> @sc) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd28: &#39;$sd[2]&#39;:&#39;$sd[1]&#39;:&#39;$sd[0]&#39;:&#39;$sd[3]&#39;\nmod_sshc28: &#39;$sc[2]&#39;:&#39;$sc[1]&#39;:&#39;$sc[0]&#39;:&#39;$sc[3]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>],$sc[<span style=color:#ae81ff>0</span>]) }
<span style=color:#75715e>#</span>
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;IN: %s@ \(%s\) &#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;OUT=&gt; %s@%s \(%s\)&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) {
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd29: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sd[2]&#39;\nmod_sshc29: &#39;$sc[0]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;PPAM: h: %s, u: %s, p: %s&#39;</span>,<span style=color:#e6db74>&#39;-C 3&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s%s, p: %s, key:&#39;</span>,<span style=color:#e6db74>&#39;-B 5&#39;</span>); <span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[2] =~ m|^/</span><span style=color:#f92672>|</span>) {
  <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd30: &#39;$sd[3]&#39;;hash:&#39;$sd[2]&#39;:&#39;$sd[6]&#39;;$sd[4]&#39;:&#39;$sd[5]&#39;\nmod_sshc30: &#39;$sc[5]&#39;;hash:&#39;$sc[0]&#39;:???;&#39;$sc[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>4</span>],$sd[<span style=color:#ae81ff>5</span>],$sc[<span style=color:#ae81ff>2</span>])}

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;IN: %s -&gt; %s : %s&#39;</span>); <span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> @xbin1 <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x01-\x7e]{6,})/g</span>);<span style=color:#66d9ef>my</span> @xbin2;<span style=color:#66d9ef>foreach</span> <span style=color:#66d9ef>my</span> $q (@xbin1) {
$q <span style=color:#f92672>=</span> $q <span style=color:#f92672>^</span> chr(<span style=color:#ae81ff>0x22</span>) x length $q <span style=color:#66d9ef>if</span> $q <span style=color:#f92672>=~</span><span style=color:#e6db74>/[\x00-\x09\x0B-\x1F]/</span>;push @xbin2,($q <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x20-\x7e]{6,})/g</span>)} @sd <span style=color:#f92672>=</span> pgrep(<span style=color:#f92672>\</span>@xbin2,<span style=color:#e6db74>&#39;IN: %s -&gt; %s : %s&#39;</span>,<span style=color:#e6db74>&#39;-A 2&#39;</span>);}
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span> ) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd31: hash:&#39;$sd[2]&#39;:&#39;$sd[1]&#39;:&#39;$sd[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) } <span style=color:#75715e>#2do decrypt $sd[1] xor \x22</span>
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%Y-%m-%d %H:%M:%S&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);
<span style=color:#66d9ef>if</span> (($sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;[%s] &#39;</span> <span style=color:#f92672>or</span> $sc[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;[%s] &#39;</span>) <span style=color:#f92672>and</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>)) { <span style=color:#66d9ef>my</span> @sd1<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;\[PASSWORD\] KRB5-AUTH success! %s:%d &#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>);
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd32: md5:&#39;$sd1[0]:&#39;$sd[0]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;trying public RSA key file %s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s:%s@%s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| or $sc[0] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd33: &#39;$sd[0]&#39;:&#39;$sd[1]&#39;:&#39;$sc[0]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sc[<span style=color:#ae81ff>0</span>]) }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>h34_decr</span> { <span style=color:#66d9ef>my</span> $c<span style=color:#f92672>=</span>shift; <span style=color:#66d9ef>my</span> $res;
<span style=color:#66d9ef>my</span> $a <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ. 0123456789:?&#39;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;abcdefghijklmnopqrstuvwxyz/&#39;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\xDA\xB9\xB2\xB3\xA3\xA2\xAC\xCF\xE3\xF8\xE0\xCE\xE4&#34;</span>;
<span style=color:#66d9ef>my</span> @c<span style=color:#f92672>=</span>split(<span style=color:#e6db74>//</span>,$c); <span style=color:#66d9ef>for</span> (@c) { <span style=color:#66d9ef>my</span> $i <span style=color:#f92672>=</span> index($a,$_); <span style=color:#66d9ef>if</span> ($i <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) { $i<span style=color:#f92672>=</span><span style=color:#ae81ff>39</span> } <span style=color:#66d9ef>elsif</span> ($i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>40</span>) { $i<span style=color:#f92672>=</span>($i<span style=color:#f92672>+</span><span style=color:#ae81ff>20</span>)%40 } <span style=color:#66d9ef>else</span> {  $i<span style=color:#f92672>=</span>($i<span style=color:#f92672>+</span><span style=color:#ae81ff>20</span>)%40<span style=color:#f92672>+</span><span style=color:#ae81ff>40</span> }
$res <span style=color:#f92672>.=</span> substr($a,$i,<span style=color:#ae81ff>1</span>) } <span style=color:#66d9ef>return</span> $res }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;entrou: %s u: %s p: %s&#39;</span>,<span style=color:#e6db74>&#39;-C 4&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;saiu1: %s u: %s p: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 4&#39;</span>);
<span style=color:#66d9ef>if</span> (@sd <span style=color:#f92672>or</span> @sc) { <span style=color:#66d9ef>my</span> @xbin1 <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x20\x25\x2e-\x7a\xDA\xB9\xB2\xB3\xA3\xA2\xAC\xCF\xE3\xF8\xE0\xCE\xE4]{5,})/g</span>);
@sd<span style=color:#f92672>=</span>pgrep(<span style=color:#f92672>\</span>@xbin1,<span style=color:#e6db74>&#39;entrou: %s u: %s p: %s&#39;</span>,<span style=color:#e6db74>&#39;-C 3&#39;</span>); <span style=color:#66d9ef>my</span> @sdd; <span style=color:#66d9ef>for</span> (@sd[<span style=color:#ae81ff>4</span><span style=color:#f92672>..</span><span style=color:#ae81ff>6</span>]) { push @sdd,h34_decr($_) }
<span style=color:#66d9ef>my</span> @xbin2 <span style=color:#f92672>=</span> ($bssh <span style=color:#f92672>=~</span><span style=color:#e6db74> /([\x20\x25\x2e-\x7a\xDA\xB9\xB2\xB3\xA3\xA2\xAC\xCF\xE3\xF8\xE0\xCE\xE4]{5,})/g</span>);
@sc<span style=color:#f92672>=</span>pgrep(<span style=color:#f92672>\</span>@xbin2,<span style=color:#e6db74>&#39;saiu1: %s u: %s p: %s&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); <span style=color:#66d9ef>my</span> @scd; <span style=color:#66d9ef>for</span> (@sc[<span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>3</span>]) { push @scd,h34_decr($_) }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd34: hash:&#39;$sd[2]&#39; &#39;$sdd[0]&#39;:&#39;$sdd[1]&#39;:&#39;$sdd[2]&#39;\nmod_sshc34: &#39;$scd[0]&#39;:&#39;$scd[1]&#39;:&#39;$scd[2]&#39;\n&#34;</span>; ssh_ls($sdd[<span style=color:#ae81ff>0</span>],$scd[<span style=color:#ae81ff>0</span>]) }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>h35_decr</span> { <span style=color:#66d9ef>my</span> $f<span style=color:#f92672>=</span>shift; <span style=color:#66d9ef>my</span> $c<span style=color:#f92672>=</span>shift; $c<span style=color:#f92672>=</span>$c x <span style=color:#ae81ff>100</span>; <span style=color:#66d9ef>my</span> $fn; open($fn,<span style=color:#e6db74>&#34;&lt;$f&#34;</span>);seek($fn,<span style=color:#f92672>-</span><span style=color:#ae81ff>400</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1024</span>,<span style=color:#ae81ff>2</span>);<span style=color:#66d9ef>my</span> $q <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;$fn&gt;</span>; <span style=color:#66d9ef>while</span>($q<span style=color:#f92672>=</span><span style=color:#e6db74>&lt;$fn&gt;</span>) {
chomp $q; <span style=color:#66d9ef>my</span> @q<span style=color:#f92672>=</span>split(<span style=color:#e6db74>//</span>,$q); <span style=color:#66d9ef>for</span> (@q) { $_ <span style=color:#f92672>=</span> chr(ord($_)<span style=color:#f92672>-</span><span style=color:#ae81ff>12</span>) } $q<span style=color:#f92672>=</span>join(<span style=color:#e6db74>&#39;&#39;</span>,@q);$q<span style=color:#f92672>=</span>$q <span style=color:#f92672>^</span> substr($c,<span style=color:#ae81ff>0</span>,length $q);<span style=color:#66d9ef>print</span> $q<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>} close $fn}
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;trying public RSA key file %s&#39;</span>,<span style=color:#e6db74>&#39;-B 3&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s:%s@%s&#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>); <span style=color:#66d9ef>if</span> (($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| and $sd[2] =~ m|^/</span><span style=color:#f92672>|</span>) <span style=color:#f92672>or</span> $sc[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) {
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd35: &#39;$sd[0]&#39; pid:&#39;$sd[1]&#39;:&#39;$sd[2]&#39; &#39;$sc[0]&#39;:&#39;$sc[1]&#39;:&#39;$sc[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>],$sd[<span style=color:#ae81ff>2</span>],$sc[<span style=color:#ae81ff>2</span>]);
<span style=color:#66d9ef>for</span> ($sd[<span style=color:#ae81ff>1</span>],$sd[<span style=color:#ae81ff>2</span>],$sc[<span style=color:#ae81ff>2</span>]) { h35_decr($_,$sd[<span style=color:#ae81ff>0</span>] ? $sd[<span style=color:#ae81ff>0</span>] : $sc[<span style=color:#ae81ff>0</span>]) <span style=color:#66d9ef>if</span> <span style=color:#f92672>-</span>f $_ } }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;/tmp/sess_&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;/tmp/sess_&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span>[<span style=color:#f92672>\</span>da<span style=color:#f92672>-</span>f]{<span style=color:#ae81ff>32</span>}$| <span style=color:#f92672>or</span> $sc[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span>[<span style=color:#f92672>\</span>da<span style=color:#f92672>-</span>f]{<span style=color:#ae81ff>32</span>}$|) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd36: md5:&#39;$sd[0]&#39;:&#39;$sc[0]&#39;; &#39;$sd[1]&#39;:&#39;$sc[1]&#39;\n&#34;</span>; ssh_ls() }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;INCORRECT&#39;</span>,<span style=color:#e6db74>&#39;-C 2&#39;</span>);<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span><span style=color:#e6db74>/| and $sd[3] =~ m|^/</span><span style=color:#f92672>|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd37: md5:&#39;$sd[0]&#39;; &#39;$sd[1]&#39;:&#39;$sd[3]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>1</span>]) }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;\|\|\|SSH AGENT\|\|\|&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;\|\|\|SSH AGENT\|\|\|&#39;</span>); <span style=color:#66d9ef>if</span> (@sd <span style=color:#f92672>or</span> @sc) { ssh_ls() }
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> $kcr; <span style=color:#66d9ef>my</span> $kh1; <span style=color:#66d9ef>my</span> $kh2;
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> gs(<span style=color:#e6db74>&#39;Mjgg5yBS&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;MjUg5yBS&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> gs(<span style=color:#e6db74>&#39;Mjkg5yBS&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;MjYg5yBS&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> gs(<span style=color:#e6db74>&#39;ao\+v2b2L&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;ao\+v2b2L&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> gs(<span style=color:#e6db74>&#39;NDAg\+SxD&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> scalar gs(<span style=color:#e6db74>&#39;NDAg\+SxD&#39;</span>);
printf <span style=color:#e6db74>&#34;mod_sshd38: &#39;%s&#39;; kcrypt:%d, khost1:%d, khost2:%d\n&#34;</span>,$sd[<span style=color:#ae81ff>0</span>],$kcr,$kh1,$kh2 }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>my</span> $kcr; <span style=color:#66d9ef>my</span> $kh1; <span style=color:#66d9ef>my</span> $kh2;
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> gc(<span style=color:#e6db74>&#39;Mjgg5yBS&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;MjUg5yBS&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> gc(<span style=color:#e6db74>&#39;Mjkg5yBS&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;MjYg5yBS&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> gc(<span style=color:#e6db74>&#39;ao\+v2b2L&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;ao\+v2b2L&#39;</span>);
$kcr <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;u\|f=GVvB&#39;</span>); $kh1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> gc(<span style=color:#e6db74>&#39;NDAg\+SxD&#39;</span>); $kh2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> scalar gc(<span style=color:#e6db74>&#39;NDAg\+SxD&#39;</span>);
printf <span style=color:#e6db74>&#34;mod_sshc38: &#39;%s&#39;; kcrypt:%d, khost1:%d, khost2:%d\n&#34;</span>,$sc[<span style=color:#ae81ff>0</span>],$kcr,$kh1,$kh2 }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;getifaddrs&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;getifaddrs&#39;</span>);
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> $k; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> $bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xDD\x38\xD7\x60\x94\x6E\xE0\x9A\x38\x5C/</span>;
$k<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> $bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xD3\x38\xD3\x6D\x8F\x78\xA9\xC8\x2B\x4A\x6B\x57\xD5\x75/</span>; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> $bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xDA\x71\x81\x35\x99\x6D\xA3\xDE\x7B\x00/</span>;
$k<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> $bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xCE\x29\xD8\x67\x93\x66\xE9\xC0\x3C\x5D/</span>; printf <span style=color:#e6db74>&#34;mod_sshd39: detected, known:%d\n&#34;</span>,$k; ssh_ls() }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>my</span> $k; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> $bssh <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xDD\x38\xD7\x60\x94\x6E\xE0\x9A\x38\x5C/</span>;
$k<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> $bssh <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xD3\x38\xD3\x6D\x8F\x78\xA9\xC8\x2B\x4A\x6B\x57\xD5\x75/</span>; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#66d9ef>if</span> $bssh <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xDA\x71\x81\x35\x99\x6D\xA3\xDE\x7B\x00/</span>;
$k<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span> <span style=color:#66d9ef>if</span> $bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74> /\xCE\x29\xD8\x67\x93\x66\xE9\xC0\x3C\x5D/</span>; printf <span style=color:#e6db74>&#34;mod_sshc39: detected, known:%d\n&#34;</span>,$k; ssh_ls() }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;LOCAL: %s -&gt; %s : %s &#39;</span>,<span style=color:#e6db74>&#39;-C 1&#39;</span>); <span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>my</span> $sd2 <span style=color:#f92672>=</span> $sd[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;\x17&#34;</span> x length $sd[<span style=color:#ae81ff>2</span>]; <span style=color:#66d9ef>my</span> $sd0 <span style=color:#f92672>=</span> $sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;\x17&#34;</span> x length $sd[<span style=color:#ae81ff>0</span>];
printf <span style=color:#e6db74>&#34;mod_sshd40: crypt:&#39;%s&#39;:&#39;%s&#39;:&#39;%s&#39;\n&#34;</span>,$sd2,$sd0,$sd[<span style=color:#ae81ff>1</span>]; ssh_ls($sd0);
<span style=color:#66d9ef>my</span> $fn; open($fn,<span style=color:#e6db74>&#34;&lt;$sd0&#34;</span>);seek($fn,<span style=color:#f92672>-</span><span style=color:#ae81ff>100</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1024</span>,<span style=color:#ae81ff>2</span>);<span style=color:#66d9ef>while</span>(<span style=color:#e6db74>&lt;$fn&gt;</span>) {chomp;<span style=color:#66d9ef>print</span> $_ <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;\x14&#34;</span> x length $_} close $fn }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>h41_decr1</span> { <span style=color:#66d9ef>my</span> $q <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> @q <span style=color:#f92672>=</span> split(<span style=color:#e6db74>//</span>,$q); <span style=color:#66d9ef>my</span> $z <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
<span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>length $q) { $q[$z] <span style=color:#f92672>=</span> ord($q[$z]) <span style=color:#f92672>^</span> $_; $q[$z] <span style=color:#f92672>=</span> $q[$z] <span style=color:#f92672>^</span> <span style=color:#ae81ff>0x31</span>; $q[$z] <span style=color:#f92672>=</span> chr($q[$z] <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xff</span>);$z <span style=color:#f92672>=</span> $_<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span> }
<span style=color:#66d9ef>return</span> substr(join(<span style=color:#e6db74>&#39;&#39;</span>,@q),<span style=color:#ae81ff>1</span>,ord $q[<span style=color:#ae81ff>0</span>]) }
<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>h41_decr</span> { <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> shift; <span style=color:#66d9ef>my</span> $to; <span style=color:#66d9ef>my</span> $ts; <span style=color:#66d9ef>my</span> @ostr; <span style=color:#66d9ef>my</span> @q <span style=color:#f92672>=</span> (${$s} <span style=color:#f92672>=~</span><span style=color:#e6db74>/\xc6\x04\x24(.)|\xc6\x44\x24([\x00-\x7f].)|\xc6\x84\x24(..\x00\x00.)/g</span>);
<span style=color:#66d9ef>my</span> %ostr; <span style=color:#66d9ef>my</span> @l; <span style=color:#66d9ef>for</span> (@q) { <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>unless</span> $_;  <span style=color:#66d9ef>my</span> $o; <span style=color:#66d9ef>my</span> $c; <span style=color:#66d9ef>my</span> @q <span style=color:#f92672>=</span> split <span style=color:#e6db74>//</span>;
 <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> length $_) { $o<span style=color:#f92672>=</span>$q[<span style=color:#ae81ff>0</span>];$c<span style=color:#f92672>=</span>$q[<span style=color:#ae81ff>1</span>] } <span style=color:#66d9ef>elsif</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>==</span> length $_) {$o<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\x00&#34;</span>;$c<span style=color:#f92672>=</span>$q[<span style=color:#ae81ff>0</span>]} <span style=color:#66d9ef>else</span> { $o<span style=color:#f92672>=</span>$q[<span style=color:#ae81ff>0</span>];$c<span style=color:#f92672>=</span>$q[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] } $o <span style=color:#f92672>=</span> ord $o;
<span style=color:#75715e># &#39;aeiouy&#39; &#39;bcdfghklmnprstvzx&#39; standart strings</span>
 <span style=color:#66d9ef>if</span> ($o <span style=color:#f92672>!=</span> $to <span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) { <span style=color:#66d9ef>if</span> ($ts <span style=color:#f92672>and</span> length $ts <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>4</span>) { push @ostr,$ts <span style=color:#66d9ef>unless</span> $ts <span style=color:#f92672>=~</span><span style=color:#e6db74> /^\x61\x65\x69\x6f\x75|\x62\x63\x64\x66\x67/</span>}
  $ts <span style=color:#f92672>=</span> $c; $to <span style=color:#f92672>=</span> $o; } <span style=color:#66d9ef>else</span> { $ts <span style=color:#f92672>.=</span> $c; $to<span style=color:#f92672>++</span> } } <span style=color:#66d9ef>for</span> (@ostr) { $_ <span style=color:#f92672>=</span> h41_decr1($_) } <span style=color:#66d9ef>for</span> (@ostr) { $ostr{$_}<span style=color:#f92672>++</span> }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_ssh41_cstr: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,sort keys %ostr)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; <span style=color:#66d9ef>for</span> (keys %ostr) { push @l,$_ <span style=color:#66d9ef>if</span> m<span style=color:#f92672>|^/|</span> } ssh_ls(@l) }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s %s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd41: &#39;$sd[1]&#39; &#39;$sd[0]&#39;, crypted\n&#34;</span>; h41_decr(<span style=color:#f92672>\</span>$bsshd) }
<span style=color:#66d9ef>if</span> ($sc[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc41: &#39;$sc[1]&#39; &#39;$sc[0]&#39;, crypted\n&#34;</span>; h41_decr(<span style=color:#f92672>\</span>$bssh)  }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;^in: %s \t: %s \t: %s$&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;^out: %s \t: %s \t: %s$&#39;</span>);
<span style=color:#66d9ef>if</span> (@sd<span style=color:#f92672>||</span>@sc){<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd42: detected; log_useragent:passwd_file:passwd\n&#34;</span> <span style=color:#66d9ef>if</span> @sd;<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc42: detected\n&#34;</span> <span style=color:#66d9ef>if</span> @sc; ssh_ls() }

@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-A 1&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;%s -&gt; %s:%s\@%s&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^</span>GET <span style=color:#f92672>|</span>) { <span style=color:#66d9ef>my</span> @s <span style=color:#f92672>=</span> gs(<span style=color:#e6db74>&#39;dont&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); <span style=color:#66d9ef>my</span> $k; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dontxekm&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;buygod.n&#39;</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dont&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;buyg&#39;</span>);
    printf <span style=color:#e6db74>&#34;mod_sshd43: detected; known: %d\n&#34;</span>,$k; ssh_ls() }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>my</span> @s <span style=color:#f92672>=</span> gc(<span style=color:#e6db74>&#39;dont&#39;</span>,<span style=color:#e6db74>&#39;-A 3&#39;</span>); <span style=color:#66d9ef>my</span> $k; $k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dontxekm&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;buygod.n&#39;</span>) <span style=color:#f92672>or</span> ($s[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;dont&#39;</span> <span style=color:#f92672>and</span> $s[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;buyg&#39;</span>);
    printf <span style=color:#e6db74>&#34;mod_sshc43: detected; known: %d\n&#34;</span>,$k; ssh_ls() }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;pass_from: %s &#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;Sniffed -&gt; %s &#39;</span>,<span style=color:#e6db74>&#39;-A 13&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span>) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd44: pass:&#39;$sd[1]&#39; &#39;$sd[0]&#39;, &#39;$sd[2]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
<span style=color:#66d9ef>if</span> ($sc[<span style=color:#ae81ff>0</span>]) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc44: &#39;$sc[0]&#39; &#39;$sc[13]&#39;\n&#34;</span>; ssh_ls($sd[<span style=color:#ae81ff>0</span>]) }
@sd<span style=color:#f92672>=</span>gs(<span style=color:#e6db74>&#39;in:%s:%d:%s:%s:secret_%s&#39;</span>,<span style=color:#e6db74>&#39;-B 2&#39;</span>);@sc<span style=color:#f92672>=</span>gc(<span style=color:#e6db74>&#39;out::%s::%s:%d:%s:%s&#39;</span>,<span style=color:#e6db74>&#39;-B 1&#39;</span>);
<span style=color:#66d9ef>if</span> ($sd[<span style=color:#ae81ff>0</span>]) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshd45: pass:&#39;$sd[1]&#39; host:&#39;$sd[0]&#39;, &#39;$sd[2]&#39;\n&#34;</span>; ssh_ls() }
<span style=color:#66d9ef>if</span> ($sc[<span style=color:#ae81ff>0</span>]) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_sshc45: host:&#39;$sc[0]&#39; &#39;$sc[1]&#39;\n&#34;</span>; ssh_ls() }

<span style=color:#75715e>#@sd=gs();@sc=gc();</span>

@sd<span style=color:#f92672>=</span>();@sc<span style=color:#f92672>=</span>();<span style=color:#66d9ef>for</span> (@bsshd) { push @sd,$_ <span style=color:#66d9ef>if</span> <span style=color:#e6db74>/^[0-9a-f]{32}$/</span> } <span style=color:#66d9ef>for</span> (@bssh) { push @sc,$_ <span style=color:#66d9ef>if</span> <span style=color:#e6db74>/^[0-9a-f]{32}$/</span> }
<span style=color:#66d9ef>for</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_md5_sshd: &#39;$_&#39;\n&#34;</span> } <span style=color:#66d9ef>for</span> (@sc) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_md5_ssh: &#39;$_&#39;\n&#34;</span> }
<span style=color:#66d9ef>my</span> $static_ssl; <span style=color:#66d9ef>for</span> (@sd) { $static_ssl<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span> $_ <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;cf5ac8395bafeb13c02da292dded7a83&#39;</span> <span style=color:#f92672>or</span> $_ <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;27b6916a894d3aee7106fe805fc34b44&#39;</span> }
<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_md5_static_ssl: $static_ssl\n&#34;</span> <span style=color:#66d9ef>if</span> $static_ssl;

<span style=color:#66d9ef>my</span> @phs <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;HISTFILE&#39;</span>,<span style=color:#e6db74>&#39;GET &#39;</span>,<span style=color:#e6db74>&#39;/tmp/sess_&#39;</span>,<span style=color:#e6db74>&#39;UPX&#39;</span>,<span style=color:#e6db74>&#39;skynet&#39;</span>,<span style=color:#e6db74>&#39;libcurl&#39;</span>,<span style=color:#e6db74>&#39; \+password: &#39;</span>); <span style=color:#66d9ef>my</span> %idx;
undef %idx; <span style=color:#66d9ef>for</span> (@phs) { <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> $_; <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>scalar @bsshd) { $idx{$bsshd[$_]}<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span> $bsshd[$_] <span style=color:#f92672>=~</span><span style=color:#e6db74> /$s/</span> } } @sd <span style=color:#f92672>=</span> keys %idx;
undef %idx; <span style=color:#66d9ef>for</span> (@phs) { <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> $_; <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>scalar @bssh)  { $idx{$bssh[$_]}<span style=color:#f92672>++</span>  <span style=color:#66d9ef>if</span> $bssh[$_]  <span style=color:#f92672>=~</span><span style=color:#e6db74> /$s/</span> } } @sc <span style=color:#f92672>=</span> keys %idx;
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_hack_strd: possible hacked, &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;|&#34;</span>,@sd)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; ssh_ls() }
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_hack_strc: possible hacked, &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;|&#34;</span>,@sc)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span>; ssh_ls() }

<span style=color:#66d9ef>my</span> @q; <span style=color:#66d9ef>my</span> @md5a;
@q <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74>/\xc6\x45([\x80-\xff].)/g</span>); get_stack_strings(<span style=color:#f92672>\</span>@q);
@q <span style=color:#f92672>=</span> ($bsshd <span style=color:#f92672>=~</span><span style=color:#e6db74>/\xc6\x44\x24([\x00-\x7f].)|\xc6\x84\x24(.[\x00-\x10]\x0\x0.)/g</span>); get_stack_strings(<span style=color:#f92672>\</span>@q);
@sd<span style=color:#f92672>=</span>();<span style=color:#66d9ef>for</span> (@md5a) { push @sd,$_ <span style=color:#66d9ef>if</span> <span style=color:#e6db74>/^[0-9a-f]{32}$/</span> } <span style=color:#66d9ef>for</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_md5_sshd1: &#39;$_&#39;\n&#34;</span> }

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>get_stack_strings</span> { <span style=color:#66d9ef>my</span> $a<span style=color:#f92672>=</span>shift; <span style=color:#66d9ef>my</span> $to; <span style=color:#66d9ef>my</span> $ts; <span style=color:#66d9ef>my</span> @ostr; <span style=color:#66d9ef>my</span> %ostr;
<span style=color:#66d9ef>my</span> @ss <span style=color:#f92672>=</span> <span style=color:#e6db74>qw{ mkdir var aeiouy bcdfghklmnprstvzx bcdfghklmnprstvz 000 aeiouybcdfg hklmnprstv aeiouybcdfghklmnprstvzx klmnprstvzx bcdfg }</span>;
<span style=color:#66d9ef>for</span> (@{$a}) { <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>unless</span> $_; <span style=color:#66d9ef>my</span> @q <span style=color:#f92672>=</span> split <span style=color:#e6db74>//</span>; <span style=color:#66d9ef>my</span> $c<span style=color:#f92672>=</span>$q[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]; <span style=color:#66d9ef>my</span> $o <span style=color:#f92672>=</span> ord $q[<span style=color:#ae81ff>0</span>];
  <span style=color:#66d9ef>if</span> ($o <span style=color:#f92672>!=</span> $to <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) { push @ostr,$ts <span style=color:#66d9ef>if</span> length $ts <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>; undef $ts; $to <span style=color:#f92672>=</span> $o; $ts <span style=color:#f92672>.=</span> $c; <span style=color:#66d9ef>next</span> }
  $to<span style=color:#f92672>++</span>; <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>0</span> <span style=color:#f92672>==</span> ord $c) { push @ostr,$ts <span style=color:#66d9ef>if</span> length $ts <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>; undef $ts } <span style=color:#66d9ef>else</span> { $ts <span style=color:#f92672>.=</span> $c } }
<span style=color:#66d9ef>for</span> (@ostr) { $ostr{$_}<span style=color:#f92672>++</span> } <span style=color:#66d9ef>for</span> (@ss) { delete $ostr{$_} }
<span style=color:#75715e>#if (keys %ostr) { print &#34;mod_sshd_str: &#39;&#34;.join(&#34;&#39;:&#39;&#34;,keys %ostr).&#34;&#39;\n&#34;; }</span>
<span style=color:#66d9ef>if</span> (keys %ostr) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;mod_str_sshd_str: &#39;&#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;&#39;:&#39;&#34;</span>,keys %ostr)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39;\n&#34;</span>; ssh_ls() } <span style=color:#66d9ef>for</span> (keys %ostr) { ssh_ls($_) <span style=color:#66d9ef>if</span> m<span style=color:#f92672>|^/|</span> }
<span style=color:#66d9ef>my</span> @l <span style=color:#f92672>=</span> (grep <span style=color:#e6db74>/^\//</span>,keys %ostr);map s<span style=color:#f92672>|\</span>s<span style=color:#f92672>||</span>sg,@l; ssh_ls(@l) <span style=color:#66d9ef>if</span> @l; push @md5a,keys %ostr; } <span style=color:#75715e>#sub</span>

<span style=color:#66d9ef>my</span> @phsg <span style=color:#f92672>=</span> <span style=color:#e6db74>qw (/bin/login </span><span style=color:#e6db74>/bin/s</span>h <span style=color:#e6db74>/dev/</span> <span style=color:#e6db74>/dev/</span>net<span style=color:#e6db74>/tun /</span>dev<span style=color:#e6db74>/null /</span>dev<span style=color:#e6db74>/tty /</span>etc<span style=color:#e6db74>/hosts.equiv /</span>etc<span style=color:#e6db74>/motd /</span>etc<span style=color:#e6db74>/nologin /</span>etc<span style=color:#e6db74>/ssh/mo</span>duli <span style=color:#e6db74>/etc/ss</span>h<span style=color:#f92672>/</span>primes
<span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/shosts.equiv /</span>etc<span style=color:#e6db74>/ssh/ss</span>hd_config <span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/ssh_host_dsa_key /</span>etc<span style=color:#e6db74>/ssh/ss</span>h_host_key <span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/ssh_host_rsa_key /</span>etc<span style=color:#e6db74>/ssh/ss</span>h_known_hosts
<span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/ssh_known_hosts2 /</span>lib<span style=color:#e6db74>/ld-linux.so.2 /</span>nonexist <span style=color:#e6db74>/proc/</span>%ld<span style=color:#e6db74>/fd /</span>tmp<span style=color:#e6db74>/ssh-XXXXXXXXXX /</span>tmp<span style=color:#e6db74>/.X11-unix/</span>X%u <span style=color:#e6db74>/usr/</span>bin:<span style=color:#e6db74>/bin:/</span>usr<span style=color:#e6db74>/sbin:/s</span>bin
<span style=color:#e6db74>/usr/</span>bin<span style=color:#e6db74>/passwd /</span>usr<span style=color:#e6db74>/bin/x</span>auth <span style=color:#e6db74>/usr/</span>libexec<span style=color:#e6db74>/ssh-askpass /</span>var<span style=color:#e6db74>/empty/ss</span>hd <span style=color:#e6db74>/var/</span>log<span style=color:#e6db74>/btmp /</span>var<span style=color:#e6db74>/log/</span>lastlog <span style=color:#e6db74>/var/m</span>ail <span style=color:#e6db74>/var/</span>run<span style=color:#f92672>/</span>sshd<span style=color:#f92672>.</span>mm<span style=color:#f92672>.</span>XXXXXXXX
<span style=color:#e6db74>/var/</span>run<span style=color:#e6db74>/sshd.pid /</span>proc<span style=color:#e6db74>/self/oom</span>_adj <span style=color:#e6db74>/usr/</span>local<span style=color:#e6db74>/bin:/</span>usr<span style=color:#e6db74>/bin:/</span>bin:<span style=color:#e6db74>/usr/</span>bin<span style=color:#e6db74>/X11:/</span>usr<span style=color:#e6db74>/games /</span>usr<span style=color:#e6db74>/share/ss</span>h<span style=color:#e6db74>/blacklist /</span>usr<span style=color:#e6db74>/bin/ss</span>h<span style=color:#f92672>-</span>askpass
<span style=color:#e6db74>/ssh /</span>var<span style=color:#e6db74>/run/ss</span>hd <span style=color:#e6db74>/run /</span>etc<span style=color:#e6db74>/ssh/</span>blacklist <span style=color:#e6db74>/var /</span>usr<span style=color:#e6db74>/local/s</span>bin:<span style=color:#e6db74>/usr/</span>local<span style=color:#e6db74>/bin:/</span>usr<span style=color:#e6db74>/sbin:/</span>usr<span style=color:#e6db74>/bin:/s</span>bin:<span style=color:#e6db74>/bin:/</span>usr<span style=color:#e6db74>/bin/</span>X11 <span style=color:#e6db74>/lib64/</span>ld<span style=color:#f92672>-</span>linux<span style=color:#f92672>-</span>x86<span style=color:#f92672>-</span><span style=color:#ae81ff>64</span><span style=color:#f92672>.</span>so<span style=color:#ae81ff>.2</span>
<span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/ssh_host_ecdsa_key /</span>tmp<span style=color:#e6db74>/ssh-XXXXXXXXXXXX /</span>tmp<span style=color:#e6db74>/ssh-XXXXXXXX /</span>usr<span style=color:#e6db74>/bin:/</span>bin:<span style=color:#e6db74>/usr/s</span>bin:<span style=color:#e6db74>/sbin:/</span>usr<span style=color:#e6db74>/local/</span>bin <span style=color:#e6db74>/etc/ss</span>h<span style=color:#e6db74>/ssh_config /</span>tRH
<span style=color:#e6db74>/usr/</span>lib<span style=color:#e6db74>/openssh/ss</span>h<span style=color:#f92672>-</span>keysign <span style=color:#e6db74>/dev/</span>random <span style=color:#e6db74>/dev/</span>urandom <span style=color:#e6db74>/usr/</span>libexec<span style=color:#e6db74>/openssh/ss</span>h<span style=color:#f92672>-</span>keysign <span style=color:#e6db74>/sshd.mmH /</span>var<span style=color:#e6db74>/runH /</span>proc<span style=color:#e6db74>/self/oom</span>_score_adj <span style=color:#e6db74>/sYL /si</span>L <span style=color:#f92672>/</span>fff
<span style=color:#e6db74>/usr/</span>bin<span style=color:#e6db74>/X11/x</span>auth <span style=color:#e6db74>/usr/</span>X11R6<span style=color:#e6db74>/bin/x</span>auth <span style=color:#e6db74>/usr/</span>local<span style=color:#e6db74>/bin:/</span>bin:<span style=color:#e6db74>/usr/</span>bin <span style=color:#e6db74>/usr/</span>local<span style=color:#e6db74>/sbin:/</span>usr<span style=color:#e6db74>/local/</span>bin:<span style=color:#e6db74>/sbin:/</span>bin:<span style=color:#e6db74>/usr/s</span>bin:<span style=color:#e6db74>/usr/</span>bin <span style=color:#e6db74>/5r! /ss</span>hd<span style=color:#f92672>.</span>mm
<span style=color:#e6db74>/usr/</span>libexec<span style=color:#e6db74>/openssh/ss</span>h<span style=color:#f92672>-</span>askpass <span style=color:#e6db74>/var/</span>empty <span style=color:#e6db74>/usr/</span>local<span style=color:#e6db74>/sbin:/</span>usr<span style=color:#e6db74>/local/</span>bin:<span style=color:#e6db74>/usr/s</span>bin:<span style=color:#e6db74>/usr/</span>bin:<span style=color:#e6db74>/sbin:/</span>bin:<span style=color:#e6db74>/usr/</span>bin<span style=color:#e6db74>/X11:/</span>usr<span style=color:#e6db74>/games /</span>tQH <span style=color:#e6db74>/var/</span>run <span style=color:#f92672>/</span>t%H
<span style=color:#e6db74>/org/</span>freedesktop<span style=color:#e6db74>/ConsoleKit/</span>Manager <span style=color:#e6db74>/wIL /</span>primary <span style=color:#e6db74>/krb5cc_L /</span>usr<span style=color:#e6db74>/share/</span>dracut<span style=color:#e6db74>/modules.d/</span><span style=color:#ae81ff>01</span>fips <span style=color:#e6db74>/9l$ /</span>etc<span style=color:#e6db74>/ssh/ss</span>h_host_ed25519_key <span style=color:#f92672>/</span>L;d$
);push @phsg,<span style=color:#e6db74>&#39;/bin/sh /etc/ssh/sshrc&#39;</span>,<span style=color:#e6db74>&#39;/t H&#39;</span>,<span style=color:#e6db74>&#39;/t&#34;H&#39;</span>,<span style=color:#e6db74>&#39;/n[(&#39;</span>;

undef %idx; <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>scalar @bsshd) { $idx{$bsshd[$_]}<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span> $bsshd[$_] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span> } <span style=color:#66d9ef>for</span> (@phsg) { delete $idx{$_} }  @sd <span style=color:#f92672>=</span> keys %idx;
<span style=color:#66d9ef>if</span> (@sd) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;sshd_str: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@sd)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> }
undef %idx; <span style=color:#66d9ef>for</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>scalar @bssh)  { $idx{$bssh[$_]}<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span> $bssh[$_] <span style=color:#f92672>=~</span> m<span style=color:#f92672>|^/|</span> }   <span style=color:#66d9ef>for</span> (@phsg) { delete $idx{$_} }  @sc <span style=color:#f92672>=</span> keys %idx;
<span style=color:#66d9ef>if</span> (@sc) { <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;sshc_str: &#34;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;|&#39;</span>,@sc)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;\n&#34;</span> }

<span style=color:#75715e># one byte xored path</span>
<span style=color:#66d9ef>my</span> @dir <span style=color:#f92672>=</span> <span style=color:#e6db74>qw { </span><span style=color:#e6db74>/bin /</span>boo <span style=color:#e6db74>/dev /</span>etc <span style=color:#e6db74>/hom /</span>lib <span style=color:#e6db74>/los /m</span>ed <span style=color:#e6db74>/mnt /o</span>pt <span style=color:#e6db74>/pro /</span>roo <span style=color:#e6db74>/sbi /s</span>ys <span style=color:#e6db74>/tmp /</span>usr <span style=color:#f92672>/</span>var }; <span style=color:#66d9ef>my</span> %dir; <span style=color:#66d9ef>for</span> (@dir) { $dir{$_} <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> }
<span style=color:#66d9ef>my</span> @xbin1 <span style=color:#f92672>=</span> split(<span style=color:#e6db74>/\0/</span>,$bsshd); <span style=color:#66d9ef>my</span> %decr;
<span style=color:#66d9ef>foreach</span> <span style=color:#66d9ef>my</span> $q (@xbin1) { <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> length $q <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>6</span>; <span style=color:#66d9ef>my</span> $s <span style=color:#f92672>=</span> substr($q,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>); <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> index($q,$s,<span style=color:#ae81ff>1</span>) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>; <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> $s <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#39;/&#39;</span>;
<span style=color:#66d9ef>my</span> $x <span style=color:#f92672>=</span> $s <span style=color:#f92672>^</span> <span style=color:#e6db74>&#39;/&#39;</span>; <span style=color:#66d9ef>my</span> $u <span style=color:#f92672>=</span> $q <span style=color:#f92672>^</span> $x x length $q; <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> exists $dir{substr($u,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>4</span>)}; push @{$decr{ord $x}},$u }
<span style=color:#66d9ef>for</span> (keys %decr) { printf <span style=color:#e6db74>&#34;mod_ssh_crypt: 0x%02x: %s\n&#34;</span>,$_,join(<span style=color:#e6db74>&#39;|&#39;</span>,@{$decr{$_}}); ssh_ls(@{$decr{$_}}) }

} <span style=color:#75715e>#check_binary</span>

<span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>md5checkd</span> { <span style=color:#66d9ef>my</span> %kmd5; <span style=color:#66d9ef>my</span> @kmd5 <span style=color:#f92672>=</span> <span style=color:#e6db74>qw {
</span><span style=color:#e6db74>d9b07b40fbe943904b4f0159da86c8bc </span>b3bd084f0ef5fc565a3a2780dfc2cfa1 <span style=color:#ae81ff>35</span>c85049c502482fce51cfc5d936e845 f1921de25219d74453ee6dab21c247b1
d47045ff430f19271d6829c5f9928f76 df0f0bff4eae65666e00dbe2a68503a2 <span style=color:#ae81ff>2783</span>f8c50be837a51d6b9b53ceb6be72 <span style=color:#ae81ff>9</span>aee1f311e443535544c53d2e4552cf5
<span style=color:#ae81ff>8</span>a4b286b2d109c7f92fdc27650533d9f <span style=color:#ae81ff>16546</span>b5dc01265f72f17954f8a56e7ac <span style=color:#ae81ff>2</span>eb9c826c424a12287cae36afa8323e9 <span style=color:#ae81ff>3</span>a1d8010c8ed9e34d209a19269e7bfe4
<span style=color:#ae81ff>9205</span>fc4d781c211e9f5f4b0f821d0fa1 dbcfb080de0fca96b6c2f59e1965a549 <span style=color:#ae81ff>2</span>d5792ddd0259240bd8c7c53f5806807 <span style=color:#ae81ff>5</span>d1169621173219570a5282ad2489f70
<span style=color:#ae81ff>749</span>beb4e6901a8ff2a1d4271a4ace132 <span style=color:#ae81ff>780</span>ed1875fa6991e1b0bc2be543f6891 d718df89c177eadc1791f871d540f927 <span style=color:#ae81ff>89206725681</span>cf62fb49bd2326dd44231
<span style=color:#ae81ff>5</span>fa0492877235a311a60060600881ce1 <span style=color:#ae81ff>5366</span>dac2e177a92769bd8270fcd34a10 <span style=color:#ae81ff>656e4</span>d575a377d40f0d7a200fcff73fb ff17df8438d7b7996a05b4a2b51e9c72
<span style=color:#ae81ff>0</span>a7446d25b477a1d9a974ae9ee793464 <span style=color:#ae81ff>3</span>df82a358c15bffda64c59050c2b2854 <span style=color:#ae81ff>4</span>f821fa303c093963194dd1f027f5224 ad014edbb9b1f348ee8bbbfb4ac93d48
<span style=color:#ae81ff>7e4</span>f18648ef2ee8da7fef54372f3c6f9 f9d537cdf7880c4fed570fc57c2eb3bc <span style=color:#ae81ff>21</span>eb40f04a01af1355909dbc182a1e5f c12da4d5a57320c1a3f8c9a425fd5b87
e3305c8ae035d81d75cf0d4ea2ba1131 e5803fdc1cbb952f2b8d3afc1f93d13b e0ca1965b69b96829d8e8cd97802462d <span style=color:#ae81ff>03</span>d4f182a4c11671b7812d2886c8e4eb
d777c0443572ec436e3e43c6903fa1fc <span style=color:#ae81ff>3</span>b1c74f81db342018291e9d4a6b3383a <span style=color:#ae81ff>7</span>b52f9f1513fa6ad68bfbb863dcb7104 <span style=color:#ae81ff>307</span>fcbe6c719cc959929d5ededab840d
<span style=color:#ae81ff>65e115</span>cfba397dd564eee8b1bb85ffed <span style=color:#ae81ff>06</span>c2489e8562f27011074f586351552a <span style=color:#ae81ff>0</span>fe4e4d2820fc5b607b0b739c611d98d e70d44c60cc49e8461145c0fe03ff13d
<span style=color:#ae81ff>411855e137</span>b0594788248a7687a783bd e9731aa9889a51af820ea35daa63bb7f <span style=color:#ae81ff>8</span>dd87cdcff0fea8fbfd3fcdc31a4771d <span style=color:#ae81ff>4</span>d29755da8b55c422fe416ef0ed553c2
a354e528e52d8731a88a372afca0a09b ba856dce069acadff587ca95e8e63551 <span style=color:#ae81ff>66</span>fb589ed87b216cdb7ae304e32a0add f8c11462e8f2a7bf80e212e06041492b
<span style=color:#ae81ff>6</span>ea7510e7be723b31af0d586815b6a76 e1c67ff5a4b3ad0e9ff721833b7231d1 <span style=color:#ae81ff>2</span>f919935dd184563f387f4f415cda92a <span style=color:#ae81ff>4e8</span>d1eb2c03574043a16ea1ae448d752
a5019f880401a316384d866f5bce41a8 <span style=color:#ae81ff>72243</span>d05428fde263ac60a3e8f9fe60d <span style=color:#ae81ff>90</span>deb0e66c1a127450dc800e8d0ea249 e847db21db6913346a006c8f920d2de8
<span style=color:#ae81ff>66105</span>f7ae3a50984f945f94d12e2d489 af1d1eddbf0e0d028d6ae360aa2cff92 cca10aa45237f273f7c26730b2e4f720 <span style=color:#ae81ff>4352</span>a619e9cfc3053695ed9c9a656e3e
<span style=color:#ae81ff>7</span>ff0cafd485303c02c36d476dd4bb237 <span style=color:#ae81ff>82</span>c9eff38c91118fcebe3e90d412a254 <span style=color:#ae81ff>3332</span>dbd3381064fa3cce49c3c89ef522 <span style=color:#ae81ff>7</span>ad89117f2dcd6ba23e1470ebc6059ed
<span style=color:#ae81ff>5</span>b966a05058784bc72031e963a517816 <span style=color:#ae81ff>23613</span>fc7a165d671cd82532c004e08dd <span style=color:#ae81ff>8</span>bb38451f0cecfde99737c663a848d67 <span style=color:#ae81ff>991e6510</span>b70bd9c1b7d32b85af26d14e
a9061c790ada52e51dc94838f495609b <span style=color:#ae81ff>1</span>a0dbb57391d04118f5113ad3a2eaf05 <span style=color:#ae81ff>54</span>b9509553f16520d55be41144025ae6 c261ed55b66ff8f86a3becc4f98b5f83
<span style=color:#ae81ff>2</span>b960e13cfa993051348ba274680bcef <span style=color:#ae81ff>8</span>f4ba85b81f00ef7ee610a76f3b3f98d <span style=color:#ae81ff>35558</span>f61ec96d24bffe1d0293606c7b2 e8c491b6d8304b77cd6427e27ef56e8e
<span style=color:#ae81ff>6</span>c1fd3e141a19f6c92ca9ef7bb7f8ed4 <span style=color:#ae81ff>91</span>c2445fd0f0345fe25d6452fa3068cd <span style=color:#ae81ff>42</span>da5b1c2de18ec8ef4f20079a601f28 <span style=color:#ae81ff>0170</span>fe3dc1410ad97848c62145f15734
eab8aca48ac11a51cda413f96db52e03 <span style=color:#ae81ff>8600</span>c946d1fe78fc97d511dc89bbe34c aa7309841c4d0fff136fb7b1732cfe76 <span style=color:#ae81ff>6</span>addd499bfb70b0d0a6e905bf5e813b5
da061e3afbd34d28bf29ec7004af9362 <span style=color:#ae81ff>2</span>a939f5aa3666c468636ec567a0ba26a <span style=color:#ae81ff>53839</span>b6835d7005d42e1e8a63ce64183 cce0532c8387b48b2449c1029ee87990
fba1c33e79dffef0323b8c947fac91a5 <span style=color:#ae81ff>96</span>ade9326f19c1a48067c916e469785b abf7a90c36705ef679298a44af80b10b b9ef99d45f96d56c1403bc646a83f9eb
<span style=color:#ae81ff>2</span>c7962806122d1a875888c4c46f40eeb <span style=color:#ae81ff>56</span>add83f2c2ecc69defaf29a275eec27 <span style=color:#ae81ff>292</span>cbd6d339c725d3751c028e0b5d72a b9dc4b1248f6a2019bd48dbb9fc4131c
<span style=color:#ae81ff>591</span>a167c6108639e78eae7a2206c3740 d426bc3d9a4664e7e307ae403a2d3119 <span style=color:#ae81ff>573e4958</span>f37a670dba8119da770d2ccb <span style=color:#ae81ff>33</span>db358f7c07ff668952e92812424ff4
<span style=color:#ae81ff>6</span>a746c0a58d454c54ca6b40a29f0d08f <span style=color:#ae81ff>66</span>b1ee9d636d593b090afc741d0ddab6 <span style=color:#ae81ff>7365e3</span>d29626301a859c18a86b278b89 <span style=color:#ae81ff>2</span>bb3fb304983c631dd477a7605a0b87f
<span style=color:#ae81ff>1</span>b42dc992cf42e4c9abca24c361e8f26 <span style=color:#ae81ff>0</span>ac48d19b8db09c3a945678a14fc0519 ac3f22fdd8093a5613231ff42a9e3925 a858418101b0947dea07a52519a8e54a
<span style=color:#ae81ff>03314</span><span style=color:#ae81ff>97</span>a5ddb43fd6d739e127d0ebfc9 e22d19cccdf8e7dd3c00a41218c121a8 dedd962724841712a91674845aeba2da ec13d418c550f5367fdc051f789fd0de
eeb1efb2524c17ddab8955f75f66bd59 <span style=color:#ae81ff>63</span>f5b4127dc7008b26ee652feffc997d adc9a00d3c56941076115cbf7e4a8962 ebfbc1c564f5d1edc572d8d0218aaf71
cf3fe6f47511037cc75950f8ff777dce <span style=color:#ae81ff>4</span>bbf2b12d6b7f234fa01b23dc9822838 <span style=color:#ae81ff>83537</span>f8ad14d237b1e3206615d3ecc25 <span style=color:#ae81ff>8</span>d705e81fcb1b53c5d38fcd9cbf0690f
<span style=color:#ae81ff>409</span>d7d38b1ff9c7d504c635086a7c16b <span style=color:#ae81ff>85</span>ecd6b10acff2bc88900c8039c84b15 <span style=color:#ae81ff>70</span>dafdc593ee43740aaf633a5cf53826 <span style=color:#ae81ff>1</span>f55ce14db87e734cf277a4bc54d8018
<span style=color:#ae81ff>06</span>a1067cb0da1f3a179545afe2c46525 <span style=color:#ae81ff>2</span>bdffe66cefbf32d49f244ea8423f771 <span style=color:#ae81ff>2</span>bb31dc365cec95cd30bf35574a98857 cd28732d6b2b3d6d419d4d41ef594efc
<span style=color:#ae81ff>0</span>ef76aecf0c3b1644007d6576bc98842 <span style=color:#ae81ff>82</span>bf9194bb9ecc3248e73a2c1741df4e <span style=color:#ae81ff>1</span>ba933c47acade29d32e6f6d98a2cb9d f5e43bdf79235f04cfe09b2eb0e87a00
<span style=color:#ae81ff>2</span>eb9c826c424a12287cae36afa8323e9 <span style=color:#ae81ff>2783</span>f8c50be837a51d6b9b53ceb6be72 <span style=color:#ae81ff>5</span>d1169621173219570a5282ad2489f70 c12da4d5a57320c1a3f8c9a425fd5b87
e3305c8ae035d81d75cf0d4ea2ba1131 e5803fdc1cbb952f2b8d3afc1f93d13b <span style=color:#ae81ff>3</span>b1c74f81db342018291e9d4a6b3383a <span style=color:#ae81ff>7</span>b52f9f1513fa6ad68bfbb863dcb7104
<span style=color:#ae81ff>8</span>c4522efe46bea26b2c9433fbced9055 <span style=color:#ae81ff>2</span>d5792ddd0259240bd8c7c53f5806807 dbcfb080de0fca96b6c2f59e1965a549 df0f0bff4eae65666e00dbe2a68503a2
<span style=color:#ae81ff>9205</span>fc4d781c211e9f5f4b0f821d0fa1 <span style=color:#ae81ff>5366</span>dac2e177a92769bd8270fcd34a10 ff17df8438d7b7996a05b4a2b51e9c72 dd6a7bfdd41d7a6bebb129a110d98887
<span style=color:#ae81ff>3</span>df82a358c15bffda64c59050c2b2854 <span style=color:#ae81ff>03</span>d4f182a4c11671b7812d2886c8e4eb <span style=color:#ae81ff>5</span>fa0492877235a311a60060600881ce1 e0ca1965b69b96829d8e8cd97802462d
d777c0443572ec436e3e43c6903fa1fc <span style=color:#ae81ff>4</span>f821fa303c093963194dd1f027f5224 ad014edbb9b1f348ee8bbbfb4ac93d48 <span style=color:#ae81ff>7e4</span>f18648ef2ee8da7fef54372f3c6f9
f9d537cdf7880c4fed570fc57c2eb3bc <span style=color:#ae81ff>21</span>eb40f04a01af1355909dbc182a1e5f <span style=color:#ae81ff>06</span>c2489e8562f27011074f586351552a <span style=color:#ae81ff>0</span>fe4e4d2820fc5b607b0b739c611d98d
e70d44c60cc49e8461145c0fe03ff13d <span style=color:#ae81ff>411855e137</span>b0594788248a7687a783bd e9731aa9889a51af820ea35daa63bb7f <span style=color:#ae81ff>13</span>eb78d2ee07aba229f803140325fe7b
<span style=color:#ae81ff>34</span>f1b693ca545bb354dab7a525fdfbfb fc53c4273aeb37352b143ac7f340c853 <span style=color:#ae81ff>5333989</span>a5aec72b28b782809be00546a <span style=color:#ae81ff>1</span>cfe157b73a021e0c3860c2ccb55ccdd
};
<span style=color:#66d9ef>for</span> (@kmd5) { $kmd5{$_}<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> }; <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> exists $kmd5{$md5d}; <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;unk_sshd_ldd:\n&#34;</span>;
system(<span style=color:#e6db74>&#39;ldd /usr/sbin/sshd || /lib64/ld-linux-x86-64.so.2 --list /usr/sbin/sshd || /lib/ld-linux.so.2 --list /usr/sbin/sshd&#39;</span>); <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> }

<span style=color:#75715e>__END__</span></code></pre></div>
<ul class=pa0>
<li class="list di">
<a href=/tags/ssh class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">ssh</a>
</li>
<li class="list di">
<a href=/tags/honeypot class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">honeypot</a>
</li>
<li class="list di">
<a href=/tags/perl class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">perl</a>
</li>
<li class="list di">
<a href=/tags/cowrie class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">cowrie</a>
</li>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.cowrie.org/>
&copy; Cowrie 2022
</a>
<div>
<div class=ananke-socials>
<a href=https://twitter.com/micheloosterhof target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a>
<a href=https://github.com/cowrie/cowrie target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a>
</div>
</div>
</div>
</footer>
</body>
</html>